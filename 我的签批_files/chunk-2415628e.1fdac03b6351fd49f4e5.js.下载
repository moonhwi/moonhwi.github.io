(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2415628e"],{2322:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABGdBTUEAALGPC/xhBQAAAy5JREFUSA3FV81qGlEUPmrEkuouSBAUddFFdFeipl35BoFWpI/QRQshz5DspNCXKBIL6VIodWEQlcaV6Corxb9EF1q0mB97vsncwXF0Ztpqe0HOvff8fPece+6Zo4VMjNlsZj07O3vB9JB/z1nFY7FYPFDldYtJi9eX/DtPJBIFpg/g6Q2LHjOXyz3p9XrvWeaYAdx6soLHoD2ep9xu98d4PP5T7C/SlcDpdPoVg31gBe+iksl1gw9xlEwmPy+Tty5uMpiFQU+YZpj3p6Aw64UN2ZbGQdWGDPqJlZLQXONIs+dvOAIzYdMmJqB7e3snTN7O761pHq7VavZMJvNN2FM8lu8U4d3YYI9fizuX7hjZy2FGIm10AANYAJGA5SfzN4lk9sBeGYusfAqAH+tp7uzsUCQSIZtNlRIalWAwSKFQSLO/sIGaYLWx4EuevFtgqpbhcJgCgQC5XC5qtVqoVio+Fj6fTzrc9vY2XV1dLZWRlZ7W6/WvW2zkUGNlYaNSqZDdbiev9/E2SqUS3d/fK1IAjUajNJ1OqVwu08ODfsUEJkKN2qs77u7uqFgsUrPZlMABIsIuQG9vb+ni4oJubm50bYEJzC2mUrE3koaHAI/FYhI4vOp0OrS/v0+/AyrjeFAeR3wCpxGw4MNTJBo8xRiPx1QoFKjf7wsRQ8rv+YemVhtpwfN2u62IDYdDGgwGytrkZIY7xvfU9ICnCO9kMqFut0u7u7t0cHCg3LkZQ4zZxh0D+JkZBWQ1EgvJhvDCU4Bin41JGT2f7To2W1aO96WOgMKCcSQWQEX2IsFEtiMSZooMDDLmdwCfK9ZXTPx+v+SZAL2+vlYk4SHeNZ6auAa2qfCXTZj/xSr3SGhXVg6n00mj0UjydB5UKOBAAG80GuRwOOCRYGko83rAhMcoMymNxNxGtVqlbDZLy0CFmLj3fD5vVLlSwJSeExozNtAQRpZRozIodAzkGjLW42cR3SCf4kgob4oCQ3SeSgFBZ8CM0w2CnoruAxiqLOC3iBL6T5o9xWPpFNwFyt3g2jxHFGWbqo+4yuP5MMvN38Ya+pXAOMR/+Qsz7z3f/dr/tP0CZtaoNDupIXkAAAAASUVORK5CYII="},"4c7e":function(t,e,a){},"53cb":function(t,e,a){},"6de4":function(t,e,a){},"702e":function(t,e,a){"use strict";e["a"]={data:function(){return{mixServiceLink:"/site/service",mixIndexShowRoute:"launch",mixLaunchChangeStatus:1,mixShowAddMyAppsBtn:!0,mixShowHandleNum:!0,mixStartHideBreadcrumb:!0,mixshowIndexNav:!0,mixshowIndexPercent:!0,mixStartExamineSuccessClose:!1,mixShowLookForm:!1,mixBListShowEntrust:!1,mixBNewMatterShowPrinter:!1,mixBNewMatterApplyAuth:!1,mixDetailSetHeight:!0,mixStartHideBtn:[],mixStartPCHideSubmit:[],mixStartHideBpmnTab:[],mixLeaveCountryId:[],mixAwayFixed:[],mixHideBtns:[],mixHideMDetailBtn:[],mixDaiChuLiText:[],mixShowHead:!0,mixSubjectshow:!1,mixStartWidth:1098,mixApproveStype:{marginTop:"0",paddingTop:"80px"},mixIndexLaunchStyle:{},mixRepeatSubmitText:{default:"不可重复申请"},mixMStartPreviewText:{default:"预览表单"},mixCountersigntext:{default:{btnText:"加签",already:"已加签",people:"加签人员",successAlert:"成功加签",tagText:"的加签",examineAlert:"加签完成",receiptText:"加签回执",finishText:"已加签"}},mixArchivedataCustomExport:{},mixMIndexHeigth:{},mixMExamineTabSort:[1,2,3],mixAppNow:{default:"立即申请"}}},components:{mixSupportDepartCom:{template:'\n      <span>\n        <template v-if="identity.length">\n          <span style="font-weight: 700;">服务对象:</span>\n          <span v-for="(item, index) in identity" :key="index">{{item}}\n            <span v-if="index< identity.length-1">、</span>\n          </span>\n        </template>\n      </span>\n      ',props:["identity"]},mixServiceObjectCom:{template:"<em></em>"},mixMoveTipsCom:{template:"<em></em>"},mixAgentDealCom:{template:'\n      <el-button id="toEntrust" @click ="toEntrust" plain>委托设置</el-button>\n      ',methods:{toEntrust:function(){this.$router.push({path:"/site/ucenter",query:{showroute:"committalCharge"}})}}},mixMatterLaunchTabCom:{template:'\n      <div class="list-run">\n        <ul>\n          <li @click="handleStatus(0)" :class="{backBlueB: changeStatus==\'0\'}">全部</li>\n          <li @click="handleStatus(1)" :class="{backBlueB: changeStatus==\'1\'}">\n            进行中\n            <span v-if="processNum != 0">{{processNum.length > 2 ? \'...\' : processNum}}</span>\n          </li>\n          <li @click="handleStatus(2)" :class="{backBlueB: changeStatus==\'2\'}">已完成</li>\n          <li @click="handleStatus(3)" :class="{backBlueB: changeStatus==\'3\'}">已撤销</li>\n          <li @click="handleStatus(4)" :class="{backBlueB: changeStatus==\'4\'}">草稿</li>\n        </ul>\n      </div>\n      ',props:["changeStatus","processNum"],methods:{handleStatus:function(t){this.$emit("handleStatus",t)}}},mixthirdMatterLogoCom:{template:"\n      <img :src=\"appConfig.staticUrl + 'img/third.jpg'\" alt />\n      "},mixMatterLogoCom:{template:'\n      <img :src="data.logo" alt />\n      ',props:["data"]},mixMatterTodoTabCom:{template:'\n      <div class="list-run">\n        <ul>\n          <li @click="handleStatus(0)" :class="{backBlueB:changeStatus==\'0\'}">\n            全部\n          </li>\n          <li @click="handleStatus(1)" :class="{backBlueB:changeStatus==\'1\'}">\n            待处理\n            <span v-if="pendingTotal != 0">{{pendingTotal.length > 2 ? \'...\' : pendingTotal}}</span>\n          </li>\n          <li @click="handleStatus(3)" :class="{backBlueB:changeStatus==\'3\'}">\n            已处理\n          </li>\n          <li v-if="batchApps.length" @click="handleStatus(4)" :class="{backBlueB:changeStatus==\'4\'}">\n            批量处理\n          </li>\t\t\t\t\n        </ul>\n      </div>\n      ',props:["changeStatus","pendingTotal","batchApps"],methods:{handleStatus:function(t){this.$emit("handleStatus",t)}}},mixTodoThirdToCom:{template:"\n      <a\n        :href=\"data.thirdparty_form_url_view\"\n        target=\"_blank\"\n      >{{data.task_status == 0 || data.task_status == 1 ? '处理事项' : '查看表单'}}</a>\n      ",props:["data"]},mixMatterMDetailCom:{template:'\n      <ul v-else>\n        <li class="appname">{{detail.name}}</li>\n        <li>\n          <span>已办理{{detail.times}}人</span>&nbsp;&nbsp;&nbsp;\n          <span>累计访问{{detail.views}}人</span>\n        </li>\n        <li v-if="detail.depart && detail.depart.length">\n          <span>服务部门：</span>\n          &nbsp;\n          <span class="appdepart">{{detail.depart.join(\'；\')}}</span>\n        </li>\n        <li>\n          <span>起始时间：</span>\n          &nbsp;\n          <span\n            class="apptime"\n          >{{detail.during_lower == null?\'无限制\':detail.during_lower}}</span>\n        </li>\n      </ul>\n      ',props:["detail"]},mixMLaunchNavCom:{template:'\n      <ul class="launchList_nav">\n        <li @click="changeStatus(0)" :class="{active:status==0}">\n          全部\n        </li>\n        <li @click="changeStatus(1)" :class="{active:status==1}">\n          进行中\n          <span v-if="processNum!=0">{{processNum}}</span>\n        </li>\n        <li @click="changeStatus(2)" :class="{active:status==2}">\n          已完成\n        </li>\n        <li @click="changeStatus(3)" :class="{active:status==3}">\n          已撤销\n        </li>\n        <li @click="changeStatus(4)" :class="{active:status==4}">\n          草稿\n        </li>\n      </ul>\n      ',props:["processNum","status"],methods:{changeStatus:function(t){this.$emit("changeStatus",t)}}},mixMIndexLaunchNavCom:{template:'\n      <div v-else class="myNotify_classify">\n        <ul style="padding: 0 0.3rem;">\n          <li @click="changeStatus(0)" :class="{active:status==0}">\n            全部\n          </li>\n          <li @click="changeStatus(1)" :class="{active:status==1}">\n            进行中\n          </li>\n          <li @click="changeStatus(2)" :class="{active:status==2}">\n            已完成\n          </li>\n          <li @click="changeStatus(3)" :class="{active:status==3}">\n            已撤销\n          </li>\n          <li @click="changeStatus(4)" :class="{active:status==4}">\n            草稿\n          </li>\n        </ul>\n      </div>\n      ',props:["processNum","status"],methods:{changeStatus:function(t){this.$emit("changeStatus",t)}}},mixMTodoToExamineBtnCom:{template:"\n      <button :class=\"item.task_status == 0 || item.task_status == 1 ? 'examine' : 'see'\" @click=\"toexamine\">\n        {{item.task_status == 0 || item.task_status == 1 ? '处理事项' : '查看表单'}}\n      </button>\n      ",props:["item"],methods:{toexamine:function(){this.$emit("toexamine")}}}},methods:{mixGetConfig:function(t,e){return this[t]&&this[t][e]?this[t][e]:this[t].default},mixSetTime:function(t){return t},mixShowRepealTo:function(){this.$router.push({path:"/matter/index"})},mixShowTakeTo:function(){window.close()},mixExamineSuccessTo:function(){this.$router.push({path:"/matter/index",query:{page:"launch"==this.$route.query.type||"reject"==this.$route.query.type?"launch":this.$route.query.type,changeStatus:void 0==this.$route.query.changeStatus?"0":this.$route.query.changeStatus}})},mixRejectStepSuccessTo:function(){this.$router.push({path:"/matter/index",query:{page:"launch"==this.$route.query.type||"reject"==this.$route.query.type?"launch":this.$route.query.type,changeStatus:void 0==this.$route.query.changeStatus?"0":this.$route.query.changeStatus}})},mixStartSuccessTo:function(t){t?this.$router.push("/matter/index"):this.$router.push({path:"/matter/m_launch",query:{type:1}})},mixMExamineSuccessTo:function(t){"launch"==t?this.$router.push({path:"/matter/m_launch",query:{type:this.$route.query.changeStatus}}):this.$router.push({path:"/matter/m_index",query:{page:t,changeStatus:void 0==this.$route.query.changeStatus?"1":this.$route.query.changeStatus}})},mixViewminBottom:function(){$(".serviceApplu-main .main-middle").css("min-height",document.body.clientHeight-198+"px")}}}},8058:function(t,e,a){},"8cc2":function(t,e,a){},"9a2b":function(t,e,a){},ab7a:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABEElEQVQ4T53TvyvFYRTH8dfNICllsNiUxSa/kpQNA3+A1ahQRlaEFCmzf8BuIJE74U+w2O4kmchAp75fPb7d++3e79mez3POu+f5nHNqqkc/FmsV65dxgcsqgC0cI2p3OwVs4jR59XYngGnU0ZUADtsF9OAFgwXP6u0CzrBeKP7AQRHQiwncJ8lxfioU32EFjRwQ/1rFHroxhLfM6SgeTwDXiDZ+hRaABZxgJEmKc7RrDeeJ/og5fOZaAGajn9lFrn9jGM8YyMRXjGUv+2OmHmzgKPtCJITrAYl4x2Sm/bOjaOIMrtCXZP1gHjfNxr5ZG0dxi1iWiB3st9qZVnMwhQeE40tlC1c2SNGqaGGjDPALAbwqwpxfQCMAAAAASUVORK5CYII="},acae:function(t,e,a){},d8e3:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"matter"},[t.fudanMatter?s("fudanHeader"):s("frontHeader"),t._v(" "),t.mixshowIndexNav&&!t.fudanMatter?s("div",{staticClass:"matter-nav mw"},[s("breadcrumb",{attrs:{links:[{name:t.typeNames[t.showRoute],path:t.$route.path,query:t.$route.query,active:!1}]}}),t._v(" "),s("mixMoveTipsCom")],1):t._e(),t._v(" "),t.mixshowIndexNav&&!t.onlyshow?s("div",{staticClass:"option mw"},[s("ul",{staticClass:"clearfix"},[s("li",{class:{optionColor:"launch"==t.showRoute}},[s("a",{class:{active:"launch"==t.showRoute},attrs:{href:"javascript:;"},on:{click:function(e){t.showRoute="launch"}}},[t._v("\n          "+t._s(t.$t("system.mySubmit"))+"\n        ")])]),t._v(" "),t.showTodoTab?s("li",{class:{optionColor:"todo"==t.showRoute}},[s("a",{class:{active:"todo"==t.showRoute},attrs:{href:"javascript:;"},on:{click:function(e){t.showRoute="todo"}}},[t._v("\n          "+t._s(t.$t("system.myTask"))+"\n        ")])]):t._e(),t._v(" "),t.showOverseeTab?s("li",{class:{optionColor:"oversee"==t.showRoute}},[s("a",{class:{active:"oversee"==t.showRoute},attrs:{href:"javascript:;"},on:{click:function(e){t.showRoute="oversee"}}},[t._v("我的督办")])]):t._e(),t._v(" "),t.showReadTab?s("li",{class:{optionColor:"read"==t.showRoute}},[s("a",{class:{active:"read"==t.showRoute},attrs:{href:"javascript:;"},on:{click:function(e){t.showRoute="read"}}},[t._v("我的知会")])]):t._e(),t._v(" "),s("mixAgentDealCom",{directives:[{name:"show",rawName:"v-show",value:t.showTodoTab,expression:"showTodoTab"}]})],1)]):t._e(),t._v(" "),"launch"==t.showRoute?s("launch",{on:{showReport:t.handleReport}}):t._e(),t._v(" "),"todo"==t.showRoute?s("todo",{on:{showReport:t.handleReport}}):t._e(),t._v(" "),"oversee"==t.showRoute?s("oversee",{on:{showReport:t.handleReport}}):t._e(),t._v(" "),"read"==t.showRoute?s("read",{on:{showReport:t.handleReport}}):t._e(),t._v(" "),s("div",{staticClass:"alert-container"},[s("div",{attrs:{id:"resultList"}},[s("p",[t._v("处理记录")]),t._v(" "),null!=t.log?[s("ul",{staticClass:"position-relative"},[t._l(t.log.lists,(function(e,a){return s("li",{class:{isself:e.isself}},[s("p"),s("p",{class:{kuang:1}},[s("span",{class:{yuan:1,hui:1,"yuan-lan":0}}),t._v(" "),s("span",{class:{sanjiao_ce:1,hui:1,lan:0}}),t._v(" "),s("span",{class:{"font-color_1":1,ofl:1}},[t._v(t._s(e.nodeName))])]),t._v(" "),s("br"),t._v(" "),e.sign_log.length>0?s("div",{staticClass:"countersign"},t._l(e.sign_log,(function(e,a){return s("div",{key:a,staticClass:"none"},["加签"!=e.operation_desc?s("span",[t._v("【加签】")]):[t._v(" ")],t._v(" "),"string"==typeof e.userName?[s("span",[t._v(t._s(e.userName))]),t._v(" "),s("span",[t._v("  "+t._s(e.userDepartment))])]:[s("span",[t._v(t._s(e.userName.map((function(t){return t.user_name+"  "+t.user_department_name})).join("、")))])],t._v(" "),s("div",[s("span",{staticClass:"grayness"},[t._v("  "+t._s(t.$t("system.matterLog"))+": ")]),t._v(" "),s("span",{staticClass:"makeSure"},[t._v("\n                      "+t._s(e.operation_desc)+"\n                    ")])]),t._v(" "),e.comment?s("p",{staticClass:"opinionComment"},[s("span",{staticStyle:{"word-wrap":"break-word"}},[t._v(t._s(e.comment))])]):t._e(),t._v(" "),e.attachments.length>0?s("div",{staticClass:"accessory"},[s("div",[t._v("\n                        附件名称:  \n                    ")]),t._v(" "),s("div",t._l(e.attachments,(function(a,i){return s("span",{key:i,staticClass:"none"},[s("a",{staticStyle:{color:"#4285f4"},attrs:{href:t.setAttachmentsUrl(a),target:"_blank"}},[t._v(t._s(a.name)),i!=e.attachments.length-1?[t._v("、")]:t._e()],2)])})),0)]):t._e(),t._v(" "),s("p",{staticClass:"nosecond"},[t._v(t._s(e.created))]),t._v(" "),s("span",{staticClass:"end-dashed"})],2)})),0):t._e(),t._v(" "),e.is_agent_deal&&"代处理"!=e.operation_desc?s("span",[t._v("【代处理】")]):e.is_entrust?s("span",[t._v("【委托审批】")]):e.operation_desc.includes("督办")?s("span",[t._v("【督办】")]):1==e.is_revoke?s("span",[t._v(" 【收回】")]):s("span",[t._v("\n                 \n              ")]),t._v(" "),"string"==typeof e.userName?[s("span",[t._v("\n                  "+t._s(e.userName)+"\n                ")]),t._v(" "),s("span",[t._v("\n                    "+t._s(e.userDepartment)+"\n                ")])]:[s("span",[t._v(t._s(e.userName.map((function(t){return t.user_name+"  "+t.user_department_name})).join("、")))])],t._v(" "),[s("div",[s("span",{staticClass:"grayness"},[t._v("  "+t._s(t.$t("system.matterLog"))+": ")]),t._v(" "),s("span",{staticClass:"makeSure"},[t._v("\n                    "+t._s("停止"==e.operation_desc?"终止":e.operation_desc)+"\n                  ")])])],t._v(" "),s("p"),t._v(" "),e.comment?s("p",{staticClass:"opinionComment"},[s("span",{staticStyle:{"word-wrap":"break-word"}},[t._v(t._s(e.comment))])]):t._e(),t._v(" "),e.attachments.length>0?s("div",{staticClass:"accessory"},[s("div",[t._v("\n                  附件名称:  \n              ")]),t._v(" "),s("div",t._l(e.attachments,(function(a,i){return s("span",{key:i,staticClass:"none"},[s("a",{staticStyle:{color:"#4285f4"},attrs:{href:t.setAttachmentsUrl(a),target:"_blank"}},[t._v(t._s(a.name)),i!=e.attachments.length-1?[t._v("、")]:t._e()],2)])})),0)]):t._e(),t._v(" "),s("p",{staticClass:"nosecond"},[t._v(t._s(e.created))]),t._v(" "),s("span",{staticClass:"end-line"})],2)})),t._v(" "),t.log.lists&&t.log.lists.length<1?s("li",[s("p",{staticStyle:{"text-align":"center"}},[t._v("暂无处理记录")])]):t._e()],2)]:t._e()],2),t._v(" "),s("img",{staticClass:"launch-close",attrs:{src:a("2322"),alt:""},on:{click:t.hideAlert}}),t._v(" "),s("div",{staticClass:"point"})]),t._v(" "),s("feedback"),t._v(" "),s("toTop"),t._v(" "),s("frontFooter")],1)},i=[],n=a("e793"),r=a("97d6"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fudan_matter_header"},[a("img",{staticClass:"logo",attrs:{src:t.siteConfig.logo_src,alt:""}}),t._v(" "),a("div",{staticClass:"nav"},[a("a",{attrs:{href:"http://ehall.fudan.edu.cn"}},[t._v("首页")]),t._v(" "),a("i",{staticClass:"el-icon-arrow-right"}),t._v(" "),a("router-link",{staticClass:"site",attrs:{to:{path:"/matter/index",query:{fudanHeader:1}}}},[t._v("任务中心")])],1),t._v(" "),a("div",{staticClass:"name",on:{click:function(e){return t.showControlPanel(e)}}},[a("a",{attrs:{href:"javascript:;"}},[t._v(t._s(t.name))]),t._v(" "),a("i",{staticClass:"el-icon-caret-bottom"}),t._v(" "),a("div",{staticClass:"mainheader-login-list"},[a("ul",[a("li",[a("a",{staticClass:"fontColor logout_a",attrs:{href:"javascript:;"},on:{click:t.loginout}},[t._v("注销")])])])])])])},c=[],l=(a("053b"),a("5557")),h=a("e644"),u={data:function(){return{name:""}},created:function(){this.name=l["a"].getSItem(h["a"].usernameKey).name},mounted:function(){$(document).click((function(t){var e=$(".mainheader-login-list");e.is(t.target)||0!==e.has(t.target).length||$(".fudan_matter_header .name").is(t.target)||0!==$(".fudan_matter_header .name").has(t.target).length||$(".fudan_matter_header .mainheader-login-list").slideUp()}))},methods:{loginout:function(t){t.preventDefault();try{h["a"].loginOut()}catch(e){console.log(e,"退出接口请求出错")}},showControlPanel:function(){$(".fudan_matter_header .mainheader-login-list").slideToggle()}}},p=(a("fc4f6"),Object(n["a"])({name:"fudanMatterHeader"},u)),d=p,_=a("9ca4"),m=Object(_["a"])(d,o,c,!1,null,null,null),v=m.exports,g=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"launch-content mw",style:[t.mixIndexLaunchStyle]},[s("mixMatterLaunchTabCom",{attrs:{changeStatus:t.changeStatus,processNum:t.processNum},on:{handleStatus:t.handleStatus}}),t._v(" "),s("div",{staticClass:"list-search"},[s("span",{staticClass:"search-time"},[t._v("服务名称")]),t._v(" "),s("el-select",{attrs:{size:"mini",filterable:"",placeholder:"搜索服务名"},model:{value:t.searchData.keyword,callback:function(e){t.$set(t.searchData,"keyword",e)},expression:"searchData.keyword"}},t._l(t.appList,(function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.name}})})),1),t._v(" "),s("span",{staticClass:"search-time"},[t._v("提交时间")]),t._v(" "),s("el-date-picker",{attrs:{type:"date",size:"mini",placeholder:"选择时间范围","value-format":"yyyy-MM-dd"},model:{value:t.searchData.time_lower,callback:function(e){t.$set(t.searchData,"time_lower","string"===typeof e?e.trim():e)},expression:"searchData.time_lower"}}),t._v(" "),s("span",{staticClass:"reduce"},[t._v("-")]),t._v(" "),s("el-date-picker",{attrs:{type:"date",size:"mini",placeholder:"选择时间范围","value-format":"yyyy-MM-dd"},model:{value:t.searchData.time_upper,callback:function(e){t.$set(t.searchData,"time_upper","string"===typeof e?e.trim():e)},expression:"searchData.time_upper"}}),t._v(" "),s("span",{staticClass:"search-button",staticStyle:{right:"12px"},on:{click:t.search}},[t._v("搜索")]),t._v(" "),s("span",{staticClass:"search-button",staticStyle:{right:"90px"},on:{click:t.reset}},[t._v("重置")])],1),t._v(" "),s("div",{staticClass:"launch-list"},[0!=t.myStartedList.length?s("ul",t._l(t.myStartedList,(function(e,a){return s("li",{key:a},[e.thirdparty_id&&0!=e.thirdparty_id?[s("div",{staticClass:"matter_list_l"},[s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.toExamine(e)}}},[s("div",{staticClass:"matter_list_l_i"},[e.thirdparty_logo?s("img",{attrs:{src:e.thirdparty_logo,alt:""}}):s("mixthirdMatterLogoCom",{attrs:{data:e}})],1),t._v(" "),s("div",{staticClass:"matter_list_l_c"},[s("p",{staticClass:"title"},[t._v(t._s(e.thirdparty_name))]),t._v(" "),s("p",{staticClass:"subtitle"},[e.tag_name?s("span",[t._v(t._s(e.tag_name))]):t._e()]),t._v(" "),s("p",{staticClass:"status",attrs:{title:t.setTitle(e)}},[e.created?s("span",[t._v("提交于："+t._s(t.mixSetTime(e.created))+" /")]):t._e(),t._v(" "),0==e.status?s("span",[t._v("\n                    当前环节：\n                    "),s("i",[t._v(t._s(e.thirdparty_node_name))])]):s("span",[t._v("办理进度：已结束")])])])])]),t._v(" "),0==e.status?s("div",{staticClass:"matter_list_r"},[s("div",[1==e.thirdparty_config_arr.urge&&-1!=e.nodes.map((function(t){return t.urge_handle})).indexOf(1)?["no"==e.is_reminder?s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return a.stopPropagation(),t.handleReminder(e)}}},[t._v("催办")]):"yes"==e.is_reminder?s("a",{attrs:{href:"javascript:;"}},[t._v("已催办")]):t._e()]:t._e(),t._v(" "),1==e.thirdparty_config_arr.log?s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.showAlert(e,a)}}},[t._v("处理记录")]):t._e()],2),t._v(" "),s("div",[s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.toExamine(e)}}},[t._v(t._s(t.$t("system.thirdpartyBtnText")))]),t._v(" "),1==e.thirdparty_config_arr.revoke?s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.handleRevoke(e.inst_id)}}},[t._v("撤销")]):t._e(),t._v(" "),1==e.thirdparty_config_arr.process_pic?s("a",{attrs:{href:e.process_pic_url?e.process_pic_url:"javascript:;",target:"_blank"}},[t._v("流程跟踪")]):t._e()])]):s("div",{staticClass:"matter_list_r"},[s("div",[1==e.thirdparty_config_arr.log?s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.showAlert(e,a)}}},[t._v("处理记录")]):t._e()]),t._v(" "),s("div",[s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.toExamine(e)}}},[t._v(t._s(t.$t("system.thirdpartyBtnText")))]),t._v(" "),1==e.thirdparty_config_arr.process_pic?s("a",{attrs:{href:e.process_pic_url?e.process_pic_url:"javascript:;",target:"_blank"}},[t._v("流程跟踪")]):t._e()])])]:e.is_draft?[s("div",{staticClass:"matter_list_l"},[s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.toExamine(e)}}},[s("div",{staticClass:"matter_list_l_i"},[s("img",{attrs:{src:e.logo,alt:""}}),t._v(" "),t._e()]),t._v(" "),s("div",{staticClass:"matter_list_l_c"},[s("p",{staticClass:"title"},[s("span",{staticClass:"primary"},[t._v("草稿")]),t._v("\n                  "+t._s(e.task_name?e.task_name:e.app_name)+"\n                ")]),t._v(" "),s("p",{staticClass:"subtitle"},[e.tag_name?s("span",[t._v(t._s(e.tag_name))]):t._e(),t._v(" "),e.task_name?s("span",[t._v(t._s(e.tag_name?" / "+e.app_name:e.app_name))]):t._e()]),t._v(" "),s("p",{staticClass:"status"},[e.created?s("span",[t._v("更新于："+t._s(t.mixSetTime(e.created)))]):t._e()])])])]),t._v(" "),s("div",{staticClass:"matter_list_r"},[t._m(0,!0),t._v(" "),s("div",[s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.toExamine(e)}}},[t._v("编辑表单")]),t._v(" "),s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.delDraft(e)}}},[t._v("删除")])])])]:[s("div",{staticClass:"matter_list_l"},[s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.toExamine(e)}}},[s("div",{staticClass:"matter_list_l_i"},[s("mixMatterLogoCom",{attrs:{data:e}}),t._v(" "),t.mixshowIndexPercent&&0==e.status?s("p",[t._v(t._s(e.percent)+"%")]):t._e()],1),t._v(" "),s("div",{staticClass:"matter_list_l_c"},[s("p",{staticClass:"title",attrs:{title:e.task_name?e.task_name:e.app_name}},[1==e.task_status&&0==e.status?s("span",{staticClass:"reject"},[t._v("驳回")]):t._e(),t._v(" "),e.primary_uid?s("span",{staticClass:"primary"},[t._v("帮"+t._s(e.primary_name)+"发起")]):t._e(),t._v("\n                  "+t._s(e.task_name?e.task_name:e.app_name)+"\n                ")]),t._v(" "),s("p",{staticClass:"subtitle",attrs:{title:e.tag_name+(e.tag_name?" / "+e.app_name:e.app_name)}},[e.tag_name?s("span",[t._v(t._s(e.tag_name))]):t._e(),t._v(" "),e.task_name?s("span",[t._v(t._s(e.tag_name?" / "+e.app_name:e.app_name))]):t._e()]),t._v(" "),1==e.app_type?s("p",{staticClass:"status",attrs:{title:t.setTitle(e)}},[e.created?s("span",[t._v("提交于："+t._s(t.mixSetTime(e.created))+" "+t._s(4!=e.status&&e.finished?"完成于："+t.mixSetTime(e.finished):"")+" /")]):t._e(),t._v(" "),s("span",[t._v("总耗时："+t._s(t.appCommonH.getSpendTime(t.mixSetTime(e.created),t.mixSetTime(e.finished)))+" /")]),t._v(" "),0==e.status?s("span",[t._v("\n                    当前环节：\n                    "),s("i",[t._v(t._s(e.nodes[0]&&e.nodes[0].node_name))])]):2==e.status?s("span",{staticClass:"success"},[t._v("成功办理")]):1==e.status?s("span",{staticClass:"stop"},[t._v("终止办理")]):4==e.status?s("span",{staticClass:"revoke"},[t._v("已撤销")]):t._e()]):s("p",{staticClass:"status"},[e.created?s("span",[t._v("提交于："+t._s(t.mixSetTime(e.created)))]):t._e()])])])]),t._v(" "),2!=e.app_type?[0==e.status?s("div",{staticClass:"matter_list_r"},[s("div",[1==e.task_status?s("a",{staticClass:"special",attrs:{href:"javascript:;"}},[t._v("注：请立刻修改，重新提交")]):[-1!=e.nodes.map((function(t){return t.urge_handle})).indexOf(1)?["no"==e.is_reminder?s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return a.stopPropagation(),t.handleReminder(e)}}},[t._v("催办")]):s("a",{staticClass:"is_reminder",attrs:{href:"javascript:;"}},[t._v("已催办")])]:t._e()],t._v(" "),s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.showAlert(e,a)}}},[t._v("处理记录")])],2),t._v(" "),s("div",[s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.toExamine(e)}}},[t._v(t._s(1==e.task_status?"处理事项":"查看表单"))]),t._v(" "),e.allow_revoke?s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.handleRevoke(e.inst_id)}}},[t._v("撤销")]):t._e(),t._v(" "),s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.toExamine(e,"bpmn")}}},[t._v("流程跟踪")])])]):s("div",{staticClass:"matter_list_r"},[s("div",[4!=e.status&&"1"==t.commentCon.enable&&"1"==e.comment_status?[0==e.is_comment?s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.showComment(e)}}},[t._v("评价")]):s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.showComment(e)}}},[t._v("已评价")])]:t._e(),t._v(" "),s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.showAlert(e,a)}}},[t._v("处理记录")])],2),t._v(" "),s("div",[s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.toExamine(e)}}},[t._v("查看表单")]),t._v(" "),s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.toExamine(e,"bpmn")}}},[t._v("流程跟踪")])])])]:t._e()]],2)})),0):[t._m(1)]],2),t._v(" "),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{"current-page":t.p,"page-sizes":[10,20,30,40,50],"page-size":t.page,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.p=e},"update:current-page":function(e){t.p=e}}})],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.rightNowBoxShow==t.rightNowList.id,expression:"rightNowBoxShow==rightNowList.id"}],staticClass:"rightNowBoxShadow"},[s("div",{staticClass:"rightNowBox",attrs:{id:"rightNowBoxShadows"}},[s("span",{staticClass:"x-span",on:{click:function(e){e.stopPropagation(),t.rightNowBoxShow=0}}},[t._v("x")]),t._v(" "),s("p",[t._v("请选择催办人员")]),t._v(" "),s("div",[s("div",{staticClass:"do_one"},t._l(t.rightNowList.nodes,(function(e,i){return s("p",{staticClass:"do_one_p ofl"},[e.urge_handle?[s("span",[t._v(t._s(e.node_name))]),t._v(" "),"no"==e.tasks[0].is_reminder?s("span",{staticClass:"do_one_p_span",on:{click:function(a){return a.stopPropagation(),t.rightNowListFn(e.node_id)}}},[t.rightNow.indexOf(e.node_id)>-1?s("img",{staticClass:"do_one_img",attrs:{src:a("ab7a")}}):t._e()]):s("span",{staticClass:"do_one_p_span"},[t.rightNow.indexOf(e.node_id)>-1?s("img",{staticClass:"do_one_img",attrs:{src:a("ab7a")}}):t._e()])]:t._e()],2)})),0)]),t._v(" "),s("div",[s("span",{staticClass:"first-span",on:{click:function(e){e.stopPropagation(),t.rightNowBoxShow=0}}},[t._v("取消")]),t._v(" "),s("span",{staticClass:"second-span",on:{click:function(e){return e.stopPropagation(),t.makeSureRightNow(e)}}},[t._v("确定")])])])]),t._v(" "),t.commentSub.inst_id?s("div",{staticClass:"launchComment_layer",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.commentSub.inst_id=!1}}},[s("div",{staticClass:"layer_container"},[s("img",{staticClass:"clear",attrs:{src:a("2322"),alt:""},on:{click:function(e){t.commentSub.inst_id=!1}}}),t._v(" "),s("p",{staticClass:"tit"},[t._v("服务评价")]),t._v(" "),t._l(t.commentSub.stars,(function(e,a){return 1==t.commentCon.star_enable?s("div",{key:a,staticClass:"comment"},[t._v("\n        "+t._s(e.item)+"：\n        "),s("el-rate",{attrs:{"disabled-void-color":"#ccc",disabled:t.is_comment},model:{value:e.star,callback:function(a){t.$set(e,"star",a)},expression:"item.star"}})],1):t._e()})),t._v(" "),1==t.commentCon.message_enable?s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentSub.message,expression:"commentSub.message"}],attrs:{disabled:t.is_comment,placeholder:"请填写你的评价内容",maxlength:t.commentCon.message_max_length},domProps:{value:t.commentSub.message},on:{input:function(e){e.target.composing||t.$set(t.commentSub,"message",e.target.value)}}}):t._e(),t._v(" "),t.is_comment?t._e():s("div",{staticClass:"btn"},[s("input",{attrs:{type:"button",value:"取消"},on:{click:function(e){t.commentSub.inst_id=!1}}}),t._v(" "),s("input",{attrs:{type:"button",value:"确定"},on:{click:function(e){return t.subComment(e)}}})])],2)]):t._e()],1)},f=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{opacity:"0"}},[a("a",{attrs:{href:"javascript:;"}},[t._v("处理记录")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"nodata"},[s("img",{attrs:{src:a("f1f1"),alt:""}}),t._v(" "),s("p",[t._v("暂无数据")])])}],y=(a("b4fb"),a("dbb3"),a("fe59"),a("ecb4"),a("ea69"),a("08ba"),a("dc64")),k=a("702e"),S=a("e673"),C={data:function(){return{matterHelper:y["a"],changeStatus:1,myStartedList:[],appList:[],yearsList:[],total:0,processNum:"0",searchLock:!1,searchData:{keyword:null,time_lower:null,time_upper:null,y:null},p:1,page:10,rightNow:[],rightNowBoxShow:0,rightNowList:[],env:window.location.origin,value1:2,commentCon:{},commentSub:{inst_id:"",stars:[],message:""},is_comment:!1}},created:function(){this.changeStatus=this.mixLaunchChangeStatus,"launch"==this.$route.query.page&&(this.changeStatus=this.$route.query.changeStatus),this.getMyStarted(this.changeStatus),this.getCommentCon(),this.getAppNameList()},mounted:function(){},methods:{getMyStarted:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this;this.appFetch({method:"get",url:"myStarted",data:{status:t,keyword:e,time_lower:a,time_upper:s,p:this.p,page_size:this.page}},(function(t){0==t.e&&(i.myStartedList=t.d.list,i.total=t.d.total,i.processNum=String(t.d.process_num))}))},getCommentCon:function(){var t=this;this.appFetch({url:"getCommentCon",method:"get"},(function(e){0==e.e?t.commentCon=e.d:t.$message.error(e.m)}))},getYears:function(){var t=this;this.appFetch({url:"getYears",method:"get"},(function(e){0==e.e?t.yearsList=e.d:t.$message.error(e.m)}))},search:function(){var t=this,e="";if(this.searchLock=!0,this.p=1,null!=t.searchData.time_lower&&null!=t.searchData.time_upper)if(t.searchData.time_lower==t.searchData.time_upper){var a=new Date(t.searchData.time_upper).getTime()+864e5;e=this.timestampToTime(a)}else e=t.searchData.time_upper;t.getMyStarted(t.changeStatus,t.searchData.keyword,t.searchData.time_lower,e)},handleStatus:function(t){$(".alert-container").hide(),this.changeStatus=t,this.p=1,this.req()},handleRevoke:function(t){var e=this,a=this;this.$MessageBox.confirm("确定要撤销这条事项?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",lockScroll:!1,type:"warning"}).then((function(){e.appFetch({method:"post",url:"revokeMatter",data:{inst_id:t}},(function(t){0==t.e?(a.$message({type:"success",message:"撤销成功!"}),a.req(a.p)):a.$message({message:t.m,type:"warning"})}),(function(t){a.$message({message:"系统错误",type:"error"})}))})).catch((function(){e.$message({type:"info",message:"已取消撤销"})}))},handleReminder:function(t){var e=this;this.rightNowList=t,this.rightNowBoxShow=t.id,this.rightNow=[],this.rightNowList.nodes.forEach((function(t){"yes"==t.tasks[0].is_reminder&&e.rightNow.push(t.node_id)}))},makeSureRightNow:function(){var t=this;this.rightNow.length>0?this.appFetch({method:"post",url:"myReminder",data:{inst_id:t.rightNowList.inst_id,node_id:t.rightNow}},(function(e){0==e.e?(t.$message({message:"催办成功",type:"success"}),t.req(t.p),t.rightNowBoxShow=0):t.$message({message:e.m,type:"warning"})})):t.$message("请选择人员进行催办")},showAlert:function(t,e){this.$emit("showReport",t,e)},handleSizeChange:function(t){this.page=t,this.p=1,this.req()},handleCurrentChange:function(t){this.req()},handleFeach:function(t){for(var e in t)t[e]=""==t[e]?null:t[e]},timestampToTime:function(t){var e=new Date(t),a=e.getFullYear()+"-",s=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",i=e.getDate();return a+s+i},rightNowListFn:function(t){-1==this.rightNow.indexOf(t)?this.rightNow.push(t):this.rightNow.splice(this.rightNow.indexOf(t),1)},req:function(){if(this.searchLock)return this.getMyStarted(this.changeStatus,this.searchData.keyword,this.searchData.time_lower,this.searchData.time_upper),!1;this.getMyStarted(this.changeStatus)},throttle:function(t,e){clearTimeout(t.tId),t.tId=setTimeout((function(){t(e)}),300)},handle:function(t){var e=[];for(var a in t)""!=this.searchData[a]&&null!=this.searchData[a]&&e.push(a);0==e.length&&this.searchLock?(this.p=1,this.searchLock=!1,this.getMyStarted(this.changeStatus)):this.searchLock&&(this.p=1,this.getMyStarted(this.changeStatus,this.searchData.keyword,this.searchData.time_lower,this.searchData.time_upper))},showComment:function(t){var e=this;0==t.is_comment?(this.commentSub.stars=[],this.commentSub.message="",this.is_comment=!1,this.commentCon.star.forEach((function(t){1==t.selected&&e.commentSub.stars.push({item:t.name,star:0})}))):(this.is_comment=!0,this.commentSub.stars=t.comment.stars,this.commentSub.message=t.comment.message),this.commentSub.inst_id=t.inst_id},subComment:function(t){var e=this;if(1==this.commentCon.message_enable&&!this.commentSub.message)return e.$message({message:"请填写评价信息",type:"warning"}),!1;$(t.target).attr("disabled",!0),this.appFetch({url:"subComment",method:"post",data:{data:JSON.stringify(this.commentSub)}},(function(a){0==a.e?($(t.target).attr("disabled",!1),e.$message({message:a.m,type:"success"}),e.commentSub.inst_id=!1,e.req(e.p)):(e.$message({message:a.m,type:"warning"}),$(t.target).attr("disabled",!1))}))},toExamine:function(t,e){var a=this;return 1==t.thirdparty_id?(window.open(encodeURI(t.thirdparty_form_url_view),"_blank"),!1):t.is_draft?void this.appFetch({url:"getProcessInfoNew",method:"get",data:{app_id:t.app_id}},(function(e){if(0==e.e){if(2==e.d.type)return void a.$router.push({path:"/matter/start",query:{id:t.app_id,is_draft:1,path:"myLaunch"}});e.d.nodes.filter((function(t){return"StartEvent"==t.node_type&&!t.node_parent_id}))[0].steps?a.$router.push({path:"/matter/startStep",query:Object(n["a"])({id:t.app_id,is_draft:1},a.appCommonH.getAgentParams(t))}):a.$router.push({path:"/matter/start",query:Object(n["a"])({id:t.app_id,is_draft:1},a.appCommonH.getAgentParams(t))})}})):1!=t.status&&2!=t.status||1!=this.commentCon.enable||1!=t.comment_status||0==t.force_comment||1==t.is_comment?(this.toUrl(t,e),!1):void this.showComment(t)},toUrl:function(t,e){0!=t.status||1!=t.task_status?this.$router.push({path:"/matter/examine",query:{type:"launch",sess_id:2==t.app_type?t.id:void 0,inst_id:t.inst_id,matterType:2==t.app_type?t.app_type:void 0,changeStatus:this.changeStatus,showBpmn:e?1:""}}):this.$router.push({path:1==t.nodes[0].steps?"/matter/rejectStep":"/matter/examine",query:{type:"reject",task_id:t.task_id,inst_id:t.inst_id,changeStatus:this.changeStatus,showBpmn:e?1:""}})},setTitle:function(t){var e="";if(t.thirdparty_id&&1==t.thirdparty_id)e+="".concat(t.created?"提交于："+this.mixSetTime(t.created)+" / ":"").concat(0==t.status?"当前环节："+t.thirdparty_node_name:"办理进度：已结束");else switch(e+=t.created?"提交于：".concat(this.mixSetTime(t.created)," ").concat(4!=t.status&&t.finished?"完成于："+this.mixSetTime(t.finished):""," / "):"",e+="总耗时：".concat(this.appCommonH.getSpendTime(this.mixSetTime(t.created),this.mixSetTime(t.finished))," / "),t.status){case 0:e+="当前环节：".concat(t.nodes[0]&&t.nodes[0].node_name);break;case 1:e+="终止办理";break;case 2:e+="办理成功";break;case 4:e+="已撤销";break}return e},delDraft:function(t){var e=this;this.$MessageBox.confirm("确定要删除这条草稿?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",lockScroll:!1,type:"warning"}).then((function(){e.appFetch({url:"pkuDelDraft",method:"post",data:{app_id:t.app_id}},(function(t){0==t.e?(e.$message.success("删除草稿成功"),e.req(e.p)):e.$message.error(t.m)}),(function(t){e.$message.error("系统错误")}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},reset:function(){this.searchData={keyword:null,time_lower:null,time_upper:null,y:null},this.p=1,this.getMyStarted(this.changeStatus)},getAppNameList:function(){var t=this;this.appFetch({url:"getAppNames",method:"get",data:{type:"launch"}},(function(e){0==e.e?t.appList=e.d:t.$message(e.m)}))}},watch:{searchData:{handler:function(t){this.throttle(this.handle,t)},deep:!0}},mixins:[k["a"],S["a"]]},w=(a("8cc2"),Object(n["a"])({name:"launch"},C)),b=w,x=Object(_["a"])(b,g,f,!1,null,null,null),T=x.exports,D=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"todo-content mw"},[s("mixMatterTodoTabCom",{attrs:{changeStatus:t.changeStatus,pendingTotal:t.pendingTotal,batchApps:t.batchApps},on:{handleStatus:t.handleStatus}}),t._v(" "),4!=t.changeStatus?s("div",{staticClass:"todo-search"},[s("div",[s("span",{staticClass:"search_span",staticStyle:{"margin-left":"0px"}},[t._v("服务名称")]),t._v(" "),s("el-select",{attrs:{size:"mini",filterable:"",placeholder:"搜索服务名"},model:{value:t.searchData.keyword,callback:function(e){t.$set(t.searchData,"keyword",e)},expression:"searchData.keyword"}},t._l(t.appList,(function(t,e){return s("el-option",{key:e,attrs:{label:t.name,value:t.name}})})),1),t._v(" "),s("span",{staticClass:"search_span"},[t._v("姓名/学工号")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.searchData.name_or_number,expression:"searchData.name_or_number",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"姓名/学工号"},domProps:{value:t.searchData.name_or_number},on:{input:function(e){e.target.composing||t.$set(t.searchData,"name_or_number",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),s("el-select",{staticClass:"search_time_type",staticStyle:{"margin-left":"12px"},attrs:{size:"mini",placeholder:"全部类型"},on:{change:t.handleSelectTimeType},model:{value:t.time_type,callback:function(e){t.time_type=e},expression:"time_type"}},[s("el-option",{attrs:{label:"到达时间",value:"0"}}),t._v(" "),s("el-option",{attrs:{label:"提交时间",value:"2"}}),t._v(" "),1!=t.changeStatus?s("el-option",{attrs:{label:"处理时间",value:"1"}}):t._e()],1),t._v(" "),s("el-date-picker",{staticStyle:{"margin-left":"4px"},attrs:{type:"date",size:"mini",placeholder:"选择时间范围","value-format":"yyyy-MM-dd"},model:{value:t.searchData.time_lower,callback:function(e){t.$set(t.searchData,"time_lower",e)},expression:"searchData.time_lower"}}),t._v(" "),s("span",{staticClass:"reduce"},[t._v("-")]),t._v(" "),s("el-date-picker",{attrs:{type:"date",size:"mini",placeholder:"选择时间范围","value-format":"yyyy-MM-dd"},model:{value:t.searchData.time_upper,callback:function(e){t.$set(t.searchData,"time_upper",e)},expression:"searchData.time_upper"}})],1),t._v(" "),s("div",[s("span",{staticClass:"search_span",staticStyle:{"margin-left":"0px"}},[t._v("发起人部门")]),t._v(" "),s("departSearch",{ref:"departSearch",staticStyle:{display:"inline-block","vertical-align":"bottom",width:"152px",height:"28px"},attrs:{id:t.searchData.department,placeholders:"搜索部门名称"},on:{"update:id":function(e){return t.$set(t.searchData,"department",e)}}}),t._v(" "),s("span",{staticClass:"search_span"},[t._v("任务类型")]),t._v(" "),s("el-select",{attrs:{size:"mini",placeholder:"全部类型"},on:{change:t.handleSelect},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.option,(function(t){return s("el-option",{key:t.option,attrs:{label:t.name,value:t.id}})})),1),t._v(" "),s("input",{staticClass:"search-button",staticStyle:{"margin-top":"-10px",right:"90px"},attrs:{type:"button",value:"重置"},on:{click:t.reset}}),t._v(" "),s("input",{staticClass:"search-button",staticStyle:{"margin-top":"-10px",right:"10px"},attrs:{type:"button",value:"搜索"},on:{click:t.search}})],1)]):[s("div",{staticClass:"todo-search2"},[s("el-select",{attrs:{placeholder:"选择事项"},on:{change:t.batchAppChange},model:{value:t.selectAppId,callback:function(e){t.selectAppId=e},expression:"selectAppId"}},t._l(t.batchApps,(function(t){return s("el-option",{key:t.id+"_"+t.bpmn_id,attrs:{label:t.name,value:t.id+"_"+t.bpmn_id}})})),1),t._v(" "),s("el-select",{staticClass:"margin_left20",attrs:{placeholder:"选择节点"},on:{change:t.batchNodeChange},model:{value:t.selectNodeId,callback:function(e){t.selectNodeId=e},expression:"selectNodeId"}},t._l(t.batchNodes,(function(t){return s("el-option",{key:t.id,attrs:{label:t.node_name,value:t.id}})})),1),t._v(" "),s("span",{staticClass:"titlename"},[t._v("发起者部门：")]),t._v(" "),t.hasChooseDepart.length?t._e():s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.showSelectDepart=!0}}},[t._v("添加")]),t._v(" "),t._l(t.hasChooseDepart,(function(e,a){return s("el-tag",{key:e.id,attrs:{closable:""},on:{close:function(e){return t.delDepart(a)}}},[t._v(t._s(e.name))])})),t._v(" "),s("input",{staticClass:"search1-button",attrs:{type:"button",value:"查询"},on:{click:t.searchTask}}),t._v(" "),s("input",{staticClass:"reset-button",attrs:{type:"button",value:"重置"},on:{click:t.resetNodeTask}}),t._v(" "),s("span",{staticClass:"batchRecord_span",on:{click:function(e){t.showBatchRecord=!0}}},[t._v(" 查看处理进度 ")])],2),t._v(" "),t.selectNodeId&&t.myTodoList.length?s("div",{staticClass:"batchselect"},[s("el-checkbox",{staticClass:"margin_right10",on:{change:t.checkAllChange},model:{value:t.isCheckAll,callback:function(e){t.isCheckAll=e},expression:"isCheckAll"}}),t._v(" "),s("el-select",{staticClass:"selecttype",model:{value:t.mutilType,callback:function(e){t.mutilType=e},expression:"mutilType"}},t._l(t.mutilTypes,(function(t){return s("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1),t._v(" "),t.selectTaskList.length?[t.batchAuth.deal.includes(-5)?s("span",{staticClass:"typebutton",on:{click:function(e){return t.selectBacthUser()}}},[t._v("代处理")]):t._e(),t._v(" "),t._l(t.batchAuth.newCustom,(function(e){return s("span",{staticClass:"typebutton",on:{click:function(a){return t.toConfirmdo(e.value)}}},[t._v(t._s(e.show_name||e.name))])}))]:t._e(),t._v(" "),s("span",{staticClass:"tasknum"},[t._v("\n          共\n          "),s("span",[t._v(t._s(t.total))]),t._v(" 条信息\n        ")])],2):t._e()],t._v(" "),s("div",{staticClass:"todo-list"},[s("el-checkbox-group",{on:{change:t.checkChange},model:{value:t.selectTaskList,callback:function(e){t.selectTaskList=e},expression:"selectTaskList"}},[0!=t.myTodoList.length?s("ul",t._l(t.myTodoList,(function(e,a){return s("li",{key:a,class:{isbatch:4==t.changeStatus}},[e.thirdparty_id&&0!=e.thirdparty_id?[s("div",{staticClass:"matter_list_l"},[s("el-checkbox",{key:e.task_id,staticClass:"selecttask",attrs:{label:e.task_id},on:{click:function(t){t.stopPropagation()}}},[t._v(t._s(""))]),t._v(" "),s("a",{attrs:{href:t.encodeUrl(e.thirdparty_form_url_view),target:"_blank"}},[s("div",{staticClass:"matter_list_l_i"},[e.thirdparty_logo?s("img",{attrs:{src:e.thirdparty_logo,alt:""}}):s("mixthirdMatterLogoCom",{attrs:{data:e,type:"todo"}})],1),t._v(" "),s("div",{staticClass:"matter_list_l_c"},[s("p",{staticClass:"title"},[t._v(t._s(e.thirdparty_name))]),t._v(" "),s("p",{staticClass:"subtitle"}),t._v(" "),s("p",{staticClass:"status",attrs:{title:t.setTitle(e)}},[s("span",[t._v("\n                        发起人：\n                        "),s("i",[t._v(t._s(e.inst_creator_name))]),t._v(" /\n                      ")]),t._v(" "),s("span",[t._v(t._s(e.inst_creator_department)+" /")]),t._v(" "),s("span",[t._v(t._s(0==e.task_status||1==e.task_status?"到达于":"处理于")+"："+t._s(0==e.task_status||1==e.task_status?t.mixSetTime(e.task_created):t.mixSetTime(e.task_finished))+" /")]),t._v(" "),s("span",[t._v("总耗时："+t._s(t.appCommonH.getSpendTime(t.mixSetTime(e.task_created),t.mixSetTime(e.task_finished)))+" /")]),t._v(" "),0==e.task_status||1==e.task_status?s("span",[t._v("\n                        当前环节：\n                        "),s("i",[t._v(t._s(e.thirdparty_node_name))])]):[s("span",[t._v("\n                          处理环节：\n                          "),s("i",[t._v(t._s(e.task_node_name))])]),t._v(" "),s("span",[t._v("\n                          / 办理进度：\n                          "),0==e.inst_status?s("i",[t._v("进行中")]):t._e(),t._v("\n                          "+t._s(0==e.inst_status?"":"已结束")+"\n                        ")])]],2)])])],1),t._v(" "),s("div",{staticClass:"matter_list_r"},[s("div",[s("a",{staticStyle:{opacity:"0",width:"1px"},attrs:{href:"javascript:;"}}),t._v(" "),t.batchErrorList.includes(e.task_id.toString())?s("a",{staticClass:"special todostatus",attrs:{href:"javascript:;"}},[t._v("重新审批处理")]):t._e(),t._v(" "),1==e.thirdparty_config_arr.log?s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.showAlert(e,a)}}},[t._v("处理记录")]):t._e()]),t._v(" "),s("div",[s("mixTodoThirdToCom",{attrs:{data:e}}),t._v(" "),1==e.thirdparty_config_arr.process_pic?s("a",{attrs:{href:e.process_pic_url?e.process_pic_url:"javascript:;",target:"_blank"}},[t._v("流程跟踪")]):t._e()],1)])]:[s("div",{staticClass:"matter_list_l"},[s("el-checkbox",{key:e.task_id,staticClass:"selecttask",attrs:{label:e.task_id},on:{click:function(t){t.stopPropagation()}}},[t._v(t._s(""))]),t._v(" "),s("router-link",{attrs:{tag:"a",target:"_blank",to:{path:e.node_config&&e.node_config.steps&&e.node_config.steps.length>1?"/matter/rejectStep":"/matter/examine",query:{type:6==e.task_status?"reject":"todo",task_id:e.task_id,inst_id:e.inst_id,changeStatus:t.changeStatus,id:e.id?e.id:"",sign:e.is_sign}}}},[s("div",{staticClass:"matter_list_l_i"},[s("mixMatterLogoCom",{attrs:{data:e,type:"todo"}}),t._v(" "),!t.mixshowIndexPercent||0!=e.task_status&&1!=e.task_status?t._e():s("p",[t._v(t._s(e.percent)+"%")])],1),t._v(" "),s("div",{staticClass:"matter_list_l_c"},[s("p",{staticClass:"title",attrs:{title:e.task_name?e.task_name:e.app_name}},["2"==e.is_sign?s("span",{staticClass:"receipt"},[t._v(t._s(t.mixGetConfig("mixCountersigntext",e.app_id).receiptText))]):t._e(),t._v(" "),"1"==e.is_sign?s("span",{staticClass:"endorse"},[t._v(t._s(e.add_sign_name)+t._s(t.mixGetConfig("mixCountersigntext",e.app_id).tagText))]):t._e(),t._v(" "),""!=e.delegate_name?s("span",{staticClass:"delegate"},[t._v("代办来自"+t._s(e.delegate_name))]):t._e(),t._v(" "),"yes"==e.urgent?s("span",{staticClass:"urgent"},[t._v("紧急")]):t._e(),t._v(" "),"yes"==e.is_reminder?s("span",{staticClass:"reminder"},[t._v("催办")]):t._e(),t._v(" "),6==e.task_status?s("span",{staticClass:"urgent"},[t._v("驳回")]):t._e(),t._v("\n                      "+t._s(e.task_name?e.task_name:e.app_name)+"\n                    ")]),t._v(" "),s("p",{staticClass:"subtitle",attrs:{title:e.tag_name+(e.tag_name?" / "+e.app_name:e.app_name)}},[e.tag_name?s("span",[t._v(t._s(e.tag_name))]):t._e(),t._v(" "),e.task_name?s("span",[t._v(t._s(e.tag_name?" / "+e.app_name:e.app_name))]):t._e()]),t._v(" "),s("p",{staticClass:"status",attrs:{title:t.setTitle(e)}},[s("span",[t._v("\n                        发起人：\n                        "),s("i",[t._v(t._s(e.inst_creator_name))]),t._v(" /\n                      ")]),t._v(" "),s("span",{staticClass:"ellipsis"},[t._v(t._s(e.inst_creator_department)+" /")]),t._v(" "),s("span",[t._v(t._s(0==e.task_status||1==e.task_status?"到达于":"处理于")+"："+t._s(0==e.task_status||1==e.task_status?t.mixSetTime(e.task_created):t.mixSetTime(e.task_finished))+" /")]),t._v(" "),s("span",[t._v("总耗时："+t._s(t.appCommonH.getSpendTime(t.mixSetTime(e.task_created),t.mixSetTime(e.task_finished)))+" /")]),t._v(" "),0==e.task_status||1==e.task_status?s("span",[t._v("\n                        当前环节：\n                        "),s("i",[t._v(t._s(e.node_name))])]):[s("span",[t._v("\n                          处理环节：\n                          "),s("i",[t._v(t._s(e.task_node_name))])]),t._v(" "),s("span",[t._v("\n                          / 办理进度：\n                          "),0==e.inst_status?s("i",[t._v("进行中")]):t._e(),t._v("\n                          "+t._s(0==e.inst_status?"":"已结束")+"\n                        ")])]],2)])])],1),t._v(" "),s("div",{staticClass:"matter_list_r"},[s("div",[t.batchErrorList.includes(e.task_id.toString())?s("a",{staticClass:"special todostatus",attrs:{href:"javascript:;"}},[t._v("重新审批处理")]):t._e(),t._v(" "),s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.showAlert(e,a)}}},[t._v("处理记录")])]),t._v(" "),s("div",[0==e.is_revoke?s("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.takeback(e)}}},[t._v("收回")]):t._e(),t._v(" "),s("router-link",{attrs:{tag:"a",target:"_blank",to:{path:e.node_config&&e.node_config.steps&&e.node_config.steps.length>1?"/matter/rejectStep":"/matter/examine",query:{type:6==e.task_status?"reject":"todo",task_id:e.task_id,inst_id:e.inst_id,changeStatus:t.changeStatus,id:e.id?e.id:"",sign:e.is_sign}}}},[t._v(t._s(0==e.task_status||1==e.task_status||6==e.task_status?"处理事项":"查看表单"))]),t._v(" "),s("router-link",{attrs:{tag:"a",target:"_blank",to:{path:e.node_config&&e.node_config.steps&&e.node_config.steps.length>1?"/matter/rejectStep":"/matter/examine",query:{type:6==e.task_status?"reject":"todo",task_id:e.task_id,inst_id:e.inst_id,changeStatus:t.changeStatus,id:e.id?e.id:"",sign:e.is_sign,showBpmn:1}}}},[t._v("流程跟踪")])],1)])]],2)})),0):[s("div",{staticClass:"nodata"},[s("img",{attrs:{src:a("f1f1"),alt:""}}),t._v(" "),s("p",{staticStyle:{"font-size":"14px"}},[t._v("暂无数据")])])]],2)],1),t._v(" "),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{"current-page":t.p,"page-sizes":[10,20,30,40,50],"page-size":t.page,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.p=e},"update:current-page":function(e){t.p=e}}})],1),t._v(" "),t.showSelectUser?s("newpop",{ref:"newpop",attrs:{isonly:!0,settype:"users",showConf:t.showConf,hasChooseList:t.hasChooseUser},on:{getBackData:t.getSelectUser}}):t._e(),t._v(" "),t.showSelectDepart?s("newpop",{attrs:{isSite:!0,isonly:!0,settype:"all",hasChooseList:t.hasChooseDepart,showConf:t.departShowConf},on:{getBackData:t.getSelectDepart}}):t._e(),t._v(" "),s("el-dialog",{attrs:{title:"确定执行“"+t.types[t.nowType]+"”操作",visible:t.isShowConfirmdo,"custom-class":"confirmdo",height:"200px;",top:"50vh","show-close":!1,center:""}},[s("div",{staticClass:"content"},[s("p",{staticClass:"donum"},[t._v("\n          总共\n          "),s("span",{staticClass:"successnum"},[t._v(t._s(2==t.mutilType&&t.isCheckAll?t.total:t.selectTaskList.length))]),t._v("条记录\n        ")]),t._v(" "),t.batchAuth.deal&&t.batchAuth.deal.includes(-1)?s("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入处理意见"},model:{value:t.batchComment,callback:function(e){t.batchComment=e},expression:"batchComment"}}):t._e()],1),t._v(" "),s("div",{staticClass:"confirmfooter",attrs:{slot:"footer"},slot:"footer"},[s("span",{staticClass:"canalbutton",on:{click:t.cancelBatch}},[t._v("取 消")]),t._v("\n            \n        "),s("span",{staticClass:"okbutton",on:{click:t.todoBatchTasks}},[t._v("确 定")])])]),t._v(" "),s("el-dialog",{attrs:{visible:t.isShowProgress,"custom-class":"progressalert",top:"50vh","show-close":!1,center:""}},[s("span",[t._v("批处理任务提交成功")]),t._v(" "),s("span",{staticClass:"progresstext",on:{click:function(e){t.closeDoResult(),t.showBatchRecord=!0}}},[t._v(" 查看进度 ")]),t._v(" "),s("span",[s("el-button",{staticStyle:{width:"80px"},attrs:{size:"mini"},on:{click:function(e){return t.closeDoResult()}}},[t._v(" 关闭 ")])],1)]),t._v(" "),s("el-dialog",{attrs:{title:"处理结果",visible:t.isShowDoresult,"custom-class":"doresult",top:"50vh","show-close":!1,center:""}},[s("div",{staticClass:"content"},[s("p",[s("span",{staticClass:"successnum"},[t._v(t._s(t.batchSuccess))]),t._v(" 条处理成功\n        ")]),t._v(" "),s("p",[s("span",{staticClass:"errornum"},[t._v(t._s(t.batchErrorList.length))]),t._v(" 条处理失败\n        ")])]),t._v(" "),s("div",{staticClass:"resultfooter",attrs:{slot:"footer"},slot:"footer"},[s("span",{staticClass:"okbutton",on:{click:t.closeDoResult}},[t._v("确 定")])])]),t._v(" "),t.takebackShow?s("div",{staticClass:"takeback"},[s("div",{staticClass:"takeback-top"},[t._v("确定收回该任务")]),t._v(" "),s("div",{staticClass:"takeback-buttom"},[s("el-button",{attrs:{size:"small"},on:{click:function(e){t.takebackShow=!1}}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.takebackSure}},[t._v("确定")])],1)]):t._e(),t._v(" "),t.showSelectEx?s("nextNode",{on:{setinfo:t.submitExUser}}):t._e(),t._v(" "),s("batchRecord",{attrs:{status:t.showBatchRecord},on:{"update:status":function(e){t.showBatchRecord=e}}})],2)},A=[],N=(a("2eeb"),a("fe8a"),a("e18c"),a("e35a"),a("1c2e"),a("0d7a"),a("9f3a")),L={data:function(){return{matterHelper:y["a"],cufe:window.location.hostname.indexOf("cufe")>-1,myTodoList:[],appList:[],yearsList:[],total:0,pendingTotal:0,rejectTotal:0,changeStatus:1,p:1,page:10,searchLock:!1,searchData:{keyword:null,time_lower:null,time_upper:null,name_or_number:null,allOption:{},time_type:null,department:null,y:null},time_type:"0",value:4,showSelectEx:!1,app_id:"",option:{0:{0:{reminder:1},option:1,name:"催办",id:1},1:{0:{delegate:1},option:2,name:"代办",id:2},2:{0:{urgent:1},option:3,name:"紧急",id:3},3:{0:{},option:4,name:"全部类型",id:4}},hasChooseUser:[],showSelectUser:!1,hasChooseDepart:[],showSelectDepart:!1,mutilTypes:[{name:"当页全选",value:1},{name:"全部全选",value:2}],mutilType:1,batchApps:[],selectAppId:"",batchNodes:[],selectNodeId:"",batchAuth:{},isCheckAll:!1,selectTaskList:[],nowBatchKey:"",batchComment:"",types:{0:"终止",1:"同意",2:"驳回",3:"提交",4:"跳转","-5":"代处理"},nowType:"",nowValue:"",isShowConfirmdo:!1,progressBar:null,isShowProgress:!1,progressNum:10,isShowDoresult:!1,batchSuccess:0,batchErrorList:[],showConf:{showStruct:!1,showDepart:!0,showJob:!0,showTag:!0,showPerson:!1,mode:"1"},departShowConf:{showStruct:!1,showDepart:!0,showJob:!0,showTag:!0,showPerson:!1,mode:"single"},takebackShow:!1,nowtakebackData:{},showBatchRecord:!1}},created:function(){"todo"==this.$route.query.page&&(this.changeStatus=this.$route.query.changeStatus),4!=this.changeStatus&&this.getMyTodo(this.changeStatus),this.getBatchNodes(),this.getAppNameList(),window.thistodo=this},mounted:function(){},computed:Object(n["a"])({},Object(N["d"])("matter",["nodeDatas","selectNodeUid","sms_send"])),methods:Object(n["a"])(Object(n["a"])({},Object(N["c"])("matter",["SET_NODEDATAS","SET_SELECTUIDS","SET_SMSSEND"])),{},{getAppNameList:function(){var t=this;this.appFetch({url:"getAppNames",method:"get",data:{type:"todo"}},(function(e){0==e.e?t.appList=e.d:t.$message(e.m)}))},submitExUser:function(t){return console.log(t),t?!!this.checkExUser()&&(this.showSelectEx=!1,void this.todoBatchTasks()):(this.showSelectEx=!1,this.SET_NODEDATAS([]),this.SET_SELECTUIDS({}),this.SET_SMSSEND({}),!1)},reset:function(){this.searchData={keyword:null,time_lower:null,time_upper:null,name_or_number:null,allOption:{},time_type:null,department:null,y:null},this.$refs.departSearch.close(),this.p=1,this.value=4,this.getMyTodo(this.changeStatus)},checkExUser:function(){var t={};for(var e in this.nodeDatas.forEach((function(e){t[e.node_key]=e.node_name})),this.selectNodeUid)if(!this.selectNodeUid[e].length)return this.$message({type:"error",message:"请先选择"+t[e]+"节点审批人",showClose:!0}),!1;return!0},getSelectUser:function(t){t&&t.length?(this.hasChooseUser=t,this.showSelectUser=!1,this.toConfirmdo("-5")):t&&0==t.length?this.$message({type:"error",message:"请选择代处理人员",showClose:!0}):this.showSelectUser=!1},getSelectDepart:function(t){t&&t.length&&(this.hasChooseDepart=t),this.showSelectDepart=!1},delDepart:function(t){this.hasChooseDepart.splice(t,1)},selectBacthUser:function(){var t=this;this.hasChooseUser=[],this.showSelectUser=!0,window.setTimeout((function(){t.$refs.newpop.selectType=2}),100)},batchAppChange:function(){this.selectNodeId="",this.batchNodes=[],this.myTodoList=[],this.total=0,this.p=1,this.mutilType=1,this.isCheckAll=!1,this.selectTaskList=[];var t=this;this.batchApps.forEach((function(e){e.id==t.selectAppId.split("_")[0]&&e.bpmn_id==t.selectAppId.split("_")[1]&&(t.batchNodes=e.nodes)}))},batchNodeChange:function(){var t=this;this.myTodoList=[],this.total=0,this.p=1,this.mutilType=1,this.isCheckAll=!1,this.selectTaskList=[],this.batchNodes.forEach((function(e){e.id==t.selectNodeId&&(t.batchAuth=e.auth,t.batchAuth.deal=t.batchAuth.common.deal?t.batchAuth.common.deal:[],t.batchAuth.newCustom=t.batchAuth.custom.filter((function(t){return-1!=t.sort})).sort((function(t,e){return t.sort-e.sort})))}))},getBatchNodes:function(){var t=this;this.appFetch({url:"getBatchNodes",method:"GET"},(function(e){0==e.e?t.batchApps=e.d.apps:t.$message({type:"error",message:e.m,showClose:!0})}),(function(){t.$message({type:"error",message:"获取可批量节点失败",showClose:!0})}))},resetNodeTask:function(){this.selectAppId="",this.selectNodeId="",this.batchAuth={},this.myTodoList=[],this.total=0,this.p=1,this.mutilType=1,this.isCheckAll=!1,this.selectTaskList=[],this.hasChooseDepart=[]},getYears:function(){var t=this;this.appFetch({url:"getYears",method:"get"},(function(e){0==e.e?t.yearsList=e.d:t.$message.error(e.m)}))},searchTask:function(){if(!this.selectNodeId)return this.$message({type:"error",message:"请先选择节点",showClose:!0}),!1;this.total=0,this.p=1,this.getTasks()},getTasks:function(){var t={node_id:this.selectNodeId,p:this.p,page_size:this.page},e=this;this.hasChooseDepart.length&&(t.depart_id=this.hasChooseDepart[0].id),this.appFetch({url:"getMyBatchList",method:"GET",data:t},(function(t){0==t.e?(e.myTodoList=t.d.list,e.total=t.d.total,""!=t.d.list&&(e.app_id=t.d.list[0].app_id)):e.$message({type:"error",message:t.m,showClose:!0})}),(function(){e.$message({type:"error",message:"获取任务列表失败",showClose:!0})}))},checkAllChange:function(){var t=this;this.selectTaskList=[],this.isCheckAll&&this.myTodoList.forEach((function(e){t.selectTaskList.push(e.task_id)}))},checkChange:function(){this.isCheckAll=0!=this.myTodoList.length&&this.selectTaskList.length==this.myTodoList.length},todoBatchTasks:function(){this.isShowConfirmdo=!1;var t=this.nowType,e=this.nowValue,a={event_key:this.getBatchKey()},s={name:this.types[t],type:t,value:e||t},i="",n=this;if(!this.appCommonH.isEmptyObj(this.selectNodeUid)||!this.appCommonH.isEmptyObj(this.sms_send))for(var r in s.special_approver=[],this.nodeDatas){var o=this.nodeDatas[r],c={node_key:o.node_key};this.selectNodeUid[o.node_key]&&(c.uids=this.selectNodeUid[o.node_key]),this.sms_send[o.node_key]&&(c.sms_send=this.sms_send[o.node_key]),s.special_approver.push(c)}2==this.mutilType&&this.isCheckAll?(i="toBatchByNodeId",a.node_id=this.selectNodeId,this.hasChooseDepart.length&&(a.depart_id=this.hasChooseDepart[0].id)):(i="toBatchByTaskIds",a.task_id=this.selectTaskList),"-5"==t&&(s.param={uid:this.hasChooseUser[0].id}),this.batchComment&&(a.comment=this.batchComment),a.operation=s,this.appFetch({url:i,data:a,method:"POST"},(function(t){0==t.e?n.isShowProgress=!0:"10100"==t.e?n.selecExUser(t.d):(n.showProgress(!1),n.$message({type:"error",message:t.m,showClose:!0}))}),(function(){n.$message({type:"error",message:"系统错误",showClose:!0})}))},selecExUser:function(t){var e={},a={};this.SET_NODEDATAS(t.nodes),this.nodeDatas.forEach((function(t){t.users&&t.users.length&&(e[t.node_key]=t.users.map((function(t){return t.uid}))),2==t.sms_permit&&(a[t.node_key]=0)})),this.SET_SELECTUIDS(e),this.SET_SMSSEND(a),this.showSelectEx=!0},getBatchKey:function(){return this.nowBatchKey=(new Date).getTime()+Math.ceil(1e4*Math.random()).toString(),this.nowBatchKey},toCommand:function(t){this.toConfirmdo(t.type,t.value)},toConfirmdo:function(t,e){if(!this.selectTaskList.length)return this.$message({type:"error",message:"请先选择可批量审批的任务",showClose:!0}),!1;this.isShowConfirmdo=!0,this.nowType=t,this.nowValue=e},cancelBatch:function(){this.isShowConfirmdo=!1,this.hasChooseUser=[]},showProgress:function(t){if(this.isShowProgress=t,this.progressNum=10,clearInterval(this.progressBar),t){var e=this;this.progressBar=setInterval((function(){e.appFetch({url:"getBatchProgress",data:{event_key:e.nowBatchKey},method:"GET"},(function(t){0==t.e&&(e.progressNum=t.d.completed/t.d.total*100,t.d.completed==t.d.total&&(clearInterval(e.progressBar),setTimeout((function(){e.isShowProgress=!1}),1e3),setTimeout((function(){e.isShowDoresult=!0}),1500)))}),(function(){console.log("获取最新进度失败")}))}),1e3)}},closeDoResult:function(){this.isShowDoresult=!1,this.isCheckAll=!1,this.isShowProgress=!1,this.selectTaskList=[],this.searchTask()},getMyTodo:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0,l=this;this.appFetch({method:"get",url:"getMyTodo",data:Object(n["a"])(Object(n["a"])({status:t,p:this.p,page_size:this.page,keyword:e,time_lower:a,time_upper:s,name_or_number:i},r),{},{time_type:o,department:c,y:this.searchData.y})},(function(e){0==e.e?(l.myTodoList=e.d.list,l.total=e.d.total,1==t&&(l.pendingTotal=String(e.d.process_num)),l.rejectTotal=String(e.d.reject_num)):l.$message(e.m)}))},handleStatus:function(t){this.p=1,this.total=0,this.changeStatus=t,4!==t?1==t&&"1"==this.time_type?(this.time_type="0",this.searchData.time_type=null):this.req():(this.myTodoList=[],this.batchApps.length&&1==this.batchApps.length&&this.batchApps[0].nodes.length&&1==this.batchApps[0].nodes.length&&(this.selectAppId=this.batchApps[0].id+"_"+this.batchApps[0].bpmn_id,this.selectNodeId=this.batchApps[0].nodes[0].id,this.batchNodes=this.batchApps[0].nodes,this.batchNodeChange()),this.selectNodeId&&this.getTasks())},search:function(){$(".alert-container").hide(),this.searchLock=!0,this.p=1,this.getMyTodo(this.changeStatus,this.searchData.keyword,this.searchData.time_lower,this.searchData.time_upper,this.searchData.name_or_number,this.searchData.allOption,this.searchData.time_type,this.searchData.department)},handleCurrentChange:function(t){4==this.changeStatus?(this.p=t||1,this.getTasks()):this.req(t)},handleSizeChange:function(t){this.page=t,this.p=1,4==this.changeStatus?this.getTasks():this.req()},handleSelect:function(){this.searchData.allOption=this.option[this.value-1][0]},handleSelectTimeType:function(){0==this.time_type?this.searchData.time_type=null:this.searchData.time_type=this.time_type},showAlert:function(t,e){this.$emit("showReport",t,e)},req:function(){if($(".alert-container").hide(),this.searchLock)return this.getMyTodo(this.changeStatus,this.searchData.keyword,this.searchData.time_lower,this.searchData.time_upper,this.searchData.name_or_number,this.searchData.allOption,this.searchData.time_type,this.searchData.department),!1;this.getMyTodo(this.changeStatus)},throttle:function(t,e){clearTimeout(t.tId),t.tId=setTimeout((function(){t(e)}),300)},handle:function(t){var e=[];for(var a in t)"allOption"!=a?""!=this.searchData[a]&&null!=this.searchData[a]&&e.push(a):0!=Object.keys(t[a]).length&&3!=Object.keys(t[a]).length&&e.push(a);0==e.length&&this.searchLock?(this.p=1,this.searchLock=!1,this.getMyTodo(this.changeStatus)):this.searchLock&&(this.p=1,this.getMyTodo(this.changeStatus,this.searchData.keyword,this.searchData.time_lower,this.searchData.time_upper,this.searchData.name_or_number,this.searchData.allOption,this.searchData.time_type,this.searchData.department))},takeback:function(t){this.takebackShow=!0,this.nowtakebackData=t},takebackSure:function(){var t=this;this.appFetch({url:"revokeTodo",method:"POST",data:{task_id:t.nowtakebackData.task_id}},(function(e){0==e.e?(t.$message({type:"success",message:e.m}),t.$router.push({path:"/matter/examine",query:{type:"todo",task_id:e.d.task_id,inst_id:t.nowtakebackData.inst_id,changeStatus:1}})):t.$message({type:"error",message:e.m})}))},setTitle:function(t){var e="发起人：".concat(t.inst_creator_name," / ").concat(t.inst_creator_department," / ").concat(0==t.task_status||1==t.task_status?"到达于":"处理于","：").concat(0==t.task_status||1==t.task_status?this.mixSetTime(t.task_created):this.mixSetTime(t.task_finished)," / 总耗时：").concat(this.appCommonH.getSpendTime(this.mixSetTime(t.task_created),this.mixSetTime(t.task_finished))," / ");return 0==t.task_status||1==t.task_status?t.thirdparty_id&&1==t.thirdparty_id?e+="当前环节：".concat(t.thirdparty_node_name):e+="当前环节：".concat(t.node_name):e+="处理环节：".concat(t.task_node_name," / 办理进度：").concat(0==t.inst_status?"进行中":"已结束"),e},encodeUrl:function(t){return encodeURI(t)}}),watch:{searchData:{handler:function(t){this.throttle(this.handle,t)},deep:!0}},mixins:[k["a"],S["a"]]},B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"batchRecord",attrs:{title:"批处理记录",visible:t.cancel,width:"50%","lock-scroll":!1,center:""},on:{"update:visible":function(e){t.cancel=e}}},[t.shouSearch?[a("div",{staticClass:"batchRecord_search"},[a("span",{staticClass:"search_box"},[t._v("\n          事项名称\n          "),a("el-select",{attrs:{size:"mini",placeholder:"选择事项"},on:{change:t.batchAppChange},model:{value:t.selectAppId,callback:function(e){t.selectAppId=e},expression:"selectAppId"}},t._l(t.batchApps,(function(t){return a("el-option",{key:t.id+"_"+t.bpmn_id,attrs:{label:t.name,value:t.id+"_"+t.bpmn_id}})})),1)],1),t._v(" "),a("span",{staticClass:"search_box"},[t._v("\n          审批环节\n          "),a("el-select",{attrs:{size:"mini",placeholder:"选择节点"},on:{change:t.batchNodeChange},model:{value:t.selectNodeId,callback:function(e){t.selectNodeId=e},expression:"selectNodeId"}},t._l(t.batchNodes,(function(t){return a("el-option",{key:t.id,attrs:{label:t.node_name,value:t.id}})})),1)],1),t._v(" "),a("span",{staticClass:"search_btn"},[a("el-button",{attrs:{size:"mini"},on:{click:t.reset}},[t._v("重置")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.searchs}},[t._v("查询")])],1)]),t._v(" "),a("div",{staticClass:"batchRecord_cont"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.batchRecordData,align:"center","header-align":"center",size:"mini",border:""}},[a("el-table-column",{attrs:{align:"center","headeifr-align":"center",prop:"app_name",width:"220",label:"任务信息"}}),t._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"node_name",label:"审批环节",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"address",width:"120",label:"已完成/失败/总数"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[a("span",{staticClass:"success"},[t._v(t._s(e.row.success_num))]),t._v("/"),a("span",{staticClass:"error"},[t._v(t._s(e.row.error_num))]),t._v("/"),a("span",[t._v(t._s(e.row.total_num))])])]}}],null,!1,2061079670)}),t._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"created",width:"170",label:"任务时间"}}),t._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"address",width:"90",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.status?a("span",[t._v("等待处理")]):1==e.row.status?a("span",{staticClass:"success"},[t._v("处理完成")]):2==e.row.status?a("span",{staticClass:"error"},[t._v("异常")]):3==e.row.status?a("span",{staticClass:"blue"},[t._v("处理中")]):t._e()]}}],null,!1,2864044005)}),t._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"address",width:"110",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[2==e.row.status?a("span",{staticClass:"refresh",on:{click:function(a){return t.refresh(e.row.id)}}},[a("span",{staticClass:"el-icon-refresh-right"}),t._v(" 重试\n              ")]):t._e(),t._v(" "),0==e.row.status?a("span",{staticClass:"refresh",on:{click:function(a){return t.delBatch(e.row.id)}}},[a("span",{staticClass:"el-icon-delete"}),t._v(" 删除\n              ")]):t._e(),t._v(" "),2==e.row.status?a("span",{staticClass:"refresh",on:{click:function(a){return t.detal(e.row)}}},[a("span",{staticClass:"el-icon-s-unfold"}),t._v(" 查看\n              ")]):t._e()]}}],null,!1,3397909062)})],1),t._v(" "),a("el-pagination",{attrs:{"current-page":t.p,"page-size":10,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.p=e},"update:current-page":function(e){t.p=e}}})],1)]:[a("div",{staticClass:"batchRecord_search"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.shouSearch=!0}}},[t._v("返回")]),t._v(" "),a("span",{staticClass:"search_box",staticStyle:{"margin-left":"8rem"}},[t._v("\n          任务信息："+t._s(t.nowErrorData.app_name)+"\n        ")]),t._v(" "),a("span",{staticClass:"search_box"},[t._v("\n          审批环节："+t._s(t.nowErrorData.node_name)+"\n        ")]),t._v(" "),a("span",{staticClass:"search_box"},[t._v("\n          失败："+t._s(t.nowErrorData.error_num)+"\n        ")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.nowErrorData.errorLost,align:"center","header-align":"center",size:"mini",border:""}},[a("el-table-column",{attrs:{align:"center","headeifr-align":"center",prop:"id",width:"220",label:"实例id"}}),t._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",prop:"ms",label:"报错信息"}})],1)]],2)},j=[],M=(a("9cf3"),a("9a2b"),{data:function(){return{cancel:!1,selectAppId:"0_0",selectNodeId:0,batchNodes:[{id:0,node_name:"全部"}],batchApps:[],shouSearch:!0,batchRecordData:[],total:0,p:1,nowErrorData:{}}},created:function(){this.getList(),this.search()},props:{status:{type:Boolean,required:!0}},watch:{cancel:function(t){t?this.reset():this.$emit("update:status",t)},status:function(t){t&&(this.cancel=t)}},mounted:function(){},methods:{batchAppChange:function(){var t=this;this.selectNodeId=0,this.batchApps.forEach((function(e){e.id==t.selectAppId.split("_")[0]&&e.bpmn_id==t.selectAppId.split("_")[1]&&(t.batchNodes=e.nodes)}))},batchNodeChange:function(){},handleCurrentChange:function(t){this.p=t,this.search()},getList:function(){var t=this;this.appFetch({url:"getBatchNodes",method:"get"},(function(e){0==e.e?(t.batchApps=e.d.apps,t.batchApps.unshift({id:0,bpmn_id:0,name:"全部",nodes:[]}),t.batchApps.forEach((function(t){t.nodes.unshift({id:0,node_name:"全部"})}))):t.$message({type:"error",message:e.m,showClose:!0})}),(function(){t.$message({type:"error",message:"系统错误",showClose:!0})}))},search:function(){var t=this;this.appFetch({url:"batchRecord",method:"post",data:{app_id:this.selectAppId.split("_")[0],node_id:this.selectNodeId,p:this.p,page_size:10}},(function(e){0==e.e?(t.batchRecordData=e.d.data,t.total=e.d.total):t.$message({type:"error",message:e.m,showClose:!0})}),(function(){t.$message({type:"error",message:"系统错误",showClose:!0})}))},refresh:function(t){var e=this;this.appFetch({url:"restBatch",method:"post",data:{id:t}},(function(t){0==t.e?(e.$message.success("操作成功"),e.search()):e.$message({type:"error",message:t.m,showClose:!0})}),(function(){e.$message({type:"error",message:"系统错误",showClose:!0})}))},delBatch:function(t){var e=this;this.appFetch({url:"delBatch",method:"post",data:{id:t}},(function(t){0==t.e?e.$message.success("删除成功"):e.$message({type:"error",message:t.m,showClose:!0}),e.search()}),(function(){e.$message({type:"error",message:"系统错误",showClose:!0})}))},searchs:function(){this.p=1,this.search()},reset:function(){this.p=1,this.selectAppId="0_0",this.selectNodeId=0,this.batchNodes=[{id:0,node_name:"全部"}],this.search()},detal:function(t){for(var e in this.nowErrorData=Object(n["a"])(Object(n["a"])({},t),{},{errorLost:[]}),t.error_ids)this.nowErrorData.errorLost.push({id:e,ms:t.error_ids[e]});this.shouSearch=!1}}}),R=M,E=Object(_["a"])(R,B,j,!1,null,null,null),O=E.exports,I=(a("4c7e"),Object(n["a"])(Object(n["a"])({name:"todo"},L),{},{components:{newpop:r["g"],nextNode:r["z"],batchRecord:O,departSearch:r["l"]}})),q=I,F=Object(_["a"])(q,D,A,!1,null,null,null),z=F.exports,P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"oversee-content mw"},[a("div",{staticClass:"list-run"},[a("ul",[a("li",{class:{backBlueB:"0"==t.changeStatus},on:{click:function(e){return t.handleStatus(0)}}},[t._v("全部")]),t._v(" "),a("li",{class:{backBlueB:"1"==t.changeStatus},on:{click:function(e){return t.handleStatus(1)}}},[t._v("\n          进行中\n          "),0!=t.process_num?a("span",[t._v(t._s(t.process_num.length>2?"...":t.process_num))]):t._e()]),t._v(" "),a("li",{class:{backBlueB:"2"==t.changeStatus},on:{click:function(e){return t.handleStatus(2)}}},[t._v("已完成")]),t._v(" "),a("li",{class:{backBlueB:"3"==t.changeStatus},on:{click:function(e){return t.handleStatus(3)}}},[t._v("已撤销")])])]),t._v(" "),a("div",{staticClass:"oversee-search"},[a("span",[t._v("服务名称")]),t._v(" "),a("el-select",{attrs:{filterable:"",placeholder:"请选择",size:"mini"},on:{change:t.handleSelect},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.option,(function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.name}})})),1),t._v(" "),a("span",[t._v("姓名/学工号")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.searchData.name_or_number,expression:"searchData.name_or_number",modifiers:{trim:!0}}],staticStyle:{"margin-right":"27px"},attrs:{type:"text",placeholder:"姓名/学工号"},domProps:{value:t.searchData.name_or_number},on:{input:function(e){e.target.composing||t.$set(t.searchData,"name_or_number",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("span",[t._v("发起人部门")]),t._v(" "),a("departSearch",{ref:"departSearch",staticStyle:{display:"inline-block","vertical-align":"bottom",width:"152px",height:"28px","line-height":"28px"},attrs:{id:t.searchData.department,placeholders:"搜索部门名称"},on:{"update:id":function(e){return t.$set(t.searchData,"department",e)}}}),t._v(" "),a("span",[t._v(t._s(t.total)+"人已申请")]),t._v(" "),a("input",{staticClass:"search_btn",attrs:{type:"button",value:"重置"},on:{click:t.reset}}),t._v(" "),a("input",{staticClass:"search_btn",staticStyle:{"margin-left":"10px"},attrs:{type:"button",value:"搜索"},on:{click:t.search}})],1),t._v(" "),a("div",{staticClass:"oversee-list"},[0!=t.myOverseeList.length?a("ul",t._l(t.myOverseeList,(function(e,s){return a("li",{key:s},[a("div",{staticClass:"matter_list_l"},[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.seeShowFn(e)}}},[a("div",{staticClass:"matter_list_l_i"},[a("mixMatterLogoCom",{attrs:{data:e}}),t._v(" "),t.mixshowIndexPercent&&0==e.status?a("p",[t._v(t._s(e.percent)+"%")]):t._e()],1),t._v(" "),a("div",{staticClass:"matter_list_l_c"},[a("p",{staticClass:"title"},["yes"==e.urgent?a("span",{staticClass:"urgent"},[t._v("紧急")]):t._e(),t._v("\n                  "+t._s(e.task_name?e.task_name:e.app_name)+"\n                ")]),t._v(" "),a("p",{staticClass:"subtitle"},[e.tag_name?a("span",[t._v(t._s(e.tag_name))]):t._e(),t._v(" "),e.task_name?a("span",[t._v(t._s(e.tag_name?" / "+e.app_name:e.app_name))]):t._e()]),t._v(" "),a("p",{staticClass:"status",attrs:{title:t.setTitle(e)}},[a("span",[t._v("\n                    发起人：\n                    "),a("i",[t._v(t._s(e.creator_name))]),t._v(" /\n                  ")]),t._v(" "),a("span",[t._v(t._s(e.user_department)+" /")]),t._v(" "),e.created?a("span",[t._v("提交于："+t._s(t.mixSetTime(e.created))+" /")]):t._e(),t._v(" "),a("span",[t._v("总耗时："+t._s(t.appCommonH.getSpendTime(t.mixSetTime(e.created),t.mixSetTime(e.finished)))+" /")]),t._v(" "),0==e.status?a("span",[t._v("\n                    当前环节：\n                    "),a("i",[t._v(t._s(e.nodes[0]&&e.nodes[0].node_name))])]):2==e.status?a("span",{staticClass:"success"},[t._v("成功办理")]):1==e.status?a("span",{staticClass:"stop"},[t._v("终止办理")]):4==e.status?a("span",{staticClass:"revoke"},[t._v("已撤销")]):t._e()])])])]),t._v(" "),a("div",{staticClass:"matter_list_r"},[a("div",[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.showAlert(e,a)}}},[t._v("处理记录")])]),t._v(" "),a("div",[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.seeShowFn(e)}}},[t._v(t._s(0==e.status?"处理事项":"查看表单"))]),t._v(" "),a("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.seeShowFn(e,"bpmn")}}},[t._v("流程跟踪")])])])])})),0):[t._m(0)]],2),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":t.p,"page-sizes":[10,20,30,40,50],"page-size":t.page,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.p=e},"update:current-page":function(e){t.p=e}}})],1),t._v(" "),t.seeShow?a("div",{staticClass:"rightNowBoxShadow"},[a("div",{staticClass:"seeBox"},[a("span",{staticClass:"x-span",on:{click:function(e){e.stopPropagation(),t.seeShow=0}}},[t._v("x")]),t._v(" "),a("p",{staticClass:"seeBox_p"},[t._v("选择要督办的任务")]),t._v(" "),a("div",{staticClass:"seeBox_div"},t._l(t.seeShowList,(function(e,s){return a("div",{staticClass:"seeBox_p_1"},[a("span",{staticClass:"seeBox_p_1_yuan"}),t._v(" "),a("span",{staticClass:"seeBox_p_1_span",on:{click:function(a){return t.showFn(e)}}},[t._v(t._s(e.node_name))]),t._v(" "),t._l(e.tasks,(function(e,s){return a("p",{staticClass:"seeBox_p_2"},[a("span",{staticClass:"seeBox_p_2_span seeBox_p_2_span_ofl",attrs:{title:e.user_name}},[a("router-link",{attrs:{to:{path:"/matter/examine",query:{type:"oversee",inst_id:t.item_show.inst_id,task_id:e.task_id,changeStatus:t.changeStatus,showBpmn:t.showBpmn}}}},[t._v(t._s(e.user_name))])],1)])}))],2)})),0)])]):t._e()])},U=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"nodata"},[s("img",{attrs:{src:a("f1f1"),alt:""}}),t._v(" "),s("p",[t._v("暂无数据")])])}],H={data:function(){return{matterHelper:y["a"],cufe:window.location.hostname.indexOf("cufe")>-1,myOverseeList:[],total:0,finishedNum:0,process_num:0,changeStatus:0,searchLock:!1,searchData:{name_or_number:"",app_id:"0",department:""},option:[],value:"",p:1,page:10,seeShow:0,seeShowList:[],seeShowListTasks:[],item_show:[],showBpmn:0}},components:{departSearch:r["l"]},created:function(){"oversee"==this.$route.query.page&&(this.changeStatus=this.$route.query.changeStatus),this.getMyOversee(this.changeStatus),this.getAppNameList()},methods:{reset:function(){this.searchData={name_or_number:"",app_id:"0",department:""},this.value="",this.p=1,this.getMyOversee(this.changeStatus)},getAppNameList:function(){var t=this;this.appFetch({url:"getAppNames",method:"get",data:{type:"oversee"}},(function(e){0==e.e?t.option=e.d:t.$message(e.m)}))},getMyOversee:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,i=this;this.appFetch({method:"get",url:"getMyOversee",data:{status:t,p:this.p,page_size:this.page,keyword:e,name_or_number:a,department:s}},(function(e){0==e.e&&(i.myOverseeList=e.d.list,i.total=e.d.total,1==t&&(i.process_num=String(e.d.process_num)))}))},handleStatus:function(t){this.p=1,this.changeStatus=t,this.req()},search:function(){this.p=1,this.searchLock=!0,this.getMyOversee(this.changeStatus,this.searchData.app_id,this.searchData.name_or_number,this.searchData.department)},handleSelect:function(){this.searchData.app_id=this.value},showAlert:function(t,e){this.$emit("showReport",t,e)},handleCurrentChange:function(t){this.req()},handleSizeChange:function(t){this.p=1,this.page=t,this.req()},seeShowFn:function(t,e){this.showBpmn=e?1:"",0!=t.nodes.length?1!=t.nodes.length||1!=t.nodes[0].tasks.length?(this.seeShowList=[],this.item_show=t,this.seeShowList=t.nodes,this.seeShow=1):this.$router.push({path:"/matter/examine",query:{type:"oversee",inst_id:t.inst_id,task_id:t.nodes[0].tasks[0].task_id,changeStatus:this.changeStatus,showBpmn:e?1:""}}):this.$router.push({path:"/matter/examine",query:{type:"oversee",inst_id:t.inst_id,changeStatus:this.changeStatus,showBpmn:e?1:""}})},showFn:function(t){console.log(t)},req:function(){if($(".alert-container").hide(),this.searchLock)return this.getMyOversee(this.changeStatus,this.searchData.app_id,this.searchData.name_or_number,this.searchData.department),!1;this.getMyOversee(this.changeStatus)},handle:function(t){var e=[];for(var a in t)""!=this.searchData[a]&&null!=this.searchData[a]&&0!=this.searchData[a]&&e.push(a);0==e.length&&this.searchLock?(this.p=1,this.searchLock=!1,this.getMyOversee(this.changeStatus)):this.searchLock&&(this.p=1,this.getMyOversee(this.changeStatus,this.searchData.app_id,this.searchData.name_or_number,this.searchData.department))},throttle:function(t,e){clearTimeout(t.tId),t.tId=setTimeout((function(){t(e)}),300)},setTitle:function(t){var e="发起人：".concat(t.creator_name," / ").concat(t.user_department," / ");switch(e+=t.created?"提交于：".concat(this.mixSetTime(t.created)," / "):"",e+="总耗时：".concat(this.appCommonH.getSpendTime(this.mixSetTime(t.created),this.mixSetTime(t.finished))," / "),t.status){case 0:e+="当前环节：".concat(t.nodes[0]&&t.nodes[0].node_name);break;case 1:e+="终止办理";break;case 2:e+="办理成功";break;case 4:e+="已撤销";break}return e}},watch:{searchData:{handler:function(t){this.throttle(this.handle,t)},deep:!0}},mixins:[k["a"],S["a"]]},G=(a("53cb"),Object(n["a"])({name:"oversee"},H)),Y=G,Z=Object(_["a"])(Y,P,U,!1,null,null,null),Q=Z.exports,J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"read_content mw"},[a("div",{staticClass:"list-run"},[a("ul",[a("li",{class:{backBlueB:0==t.changeStatus},on:{click:function(e){return t.handleStatus(0)}}},[t._v("全部")]),t._v(" "),a("li",{class:{backBlueB:1==t.changeStatus},on:{click:function(e){return t.handleStatus(1)}}},[t._v("\n          进行中\n          "),0!=t.process_num?a("span",[t._v(t._s(t.process_num.length>2?"...":t.process_num))]):t._e()]),t._v(" "),a("li",{class:{backBlueB:2==t.changeStatus},on:{click:function(e){return t.handleStatus(2)}}},[t._v("已完成")])])]),t._v(" "),a("div",{staticClass:"list-search"},[a("span",{staticClass:"search-time",staticStyle:{"margin-left":"0px"}},[t._v("服务名称")]),t._v(" "),a("el-select",{attrs:{size:"mini",filterable:"",placeholder:"搜索服务名"},model:{value:t.searchData.keyword,callback:function(e){t.$set(t.searchData,"keyword",e)},expression:"searchData.keyword"}},t._l(t.appList,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.name}})})),1),t._v(" "),a("span",{staticClass:"search-time"},[t._v("姓名/学工号")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.searchData.name_or_number,expression:"searchData.name_or_number",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"姓名/学工号"},domProps:{value:t.searchData.name_or_number},on:{input:function(e){e.target.composing||t.$set(t.searchData,"name_or_number",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("span",{staticClass:"search-time"},[t._v("提交时间")]),t._v(" "),a("el-date-picker",{attrs:{type:"date",size:"mini",placeholder:"选择时间范围","value-format":"yyyy-MM-dd"},model:{value:t.searchData.time_lower,callback:function(e){t.$set(t.searchData,"time_lower",e)},expression:"searchData.time_lower"}}),t._v(" "),a("span",{staticClass:"reduce"},[t._v("-")]),t._v(" "),a("el-date-picker",{attrs:{type:"date",size:"mini",placeholder:"选择时间范围","value-format":"yyyy-MM-dd"},model:{value:t.searchData.time_upper,callback:function(e){t.$set(t.searchData,"time_upper",e)},expression:"searchData.time_upper"}})],1),t._v(" "),a("div",{staticClass:"list-search"},[a("span",{staticClass:"search-time",staticStyle:{"margin-left":"0px","margin-right":"5px"}},[t._v("发起人部门")]),t._v(" "),a("departSearch",{ref:"departSearch",staticStyle:{display:"inline-block","vertical-align":"bottom",width:"184px",height:"28px","line-height":"28px"},attrs:{id:t.searchData.department,placeholders:"搜索部门名称"},on:{"update:id":function(e){return t.$set(t.searchData,"department",e)}}}),t._v(" "),a("span",{staticClass:"search-button",staticStyle:{right:"96px"},on:{click:t.reset}},[t._v("重置")]),t._v(" "),a("span",{staticClass:"search-button",staticStyle:{right:"16px"},on:{click:t.search}},[t._v("搜索")])],1),t._v(" "),a("div",{staticClass:"read-list"},[0!=t.myReadList.length?a("ul",t._l(t.myReadList,(function(e,s){return a("li",{key:s},[a("div",{staticClass:"matter_list_l"},[a("router-link",{attrs:{to:{path:"/matter/examine",query:{type:"read",inst_id:e.inst_id,changeStatus:t.changeStatus}}}},[a("div",{staticClass:"matter_list_l_i"},[a("mixMatterLogoCom",{attrs:{data:e}}),t._v(" "),t.mixshowIndexPercent&&0==e.status?a("p",[t._v(t._s(e.percent)+"%")]):t._e()],1),t._v(" "),a("div",{staticClass:"matter_list_l_c"},[a("p",{staticClass:"title"},["yes"==e.urgent?a("span",{staticClass:"urgent"},[t._v("紧急")]):t._e(),t._v("\n                  "+t._s(e.task_name?e.task_name:e.app_name)+"\n                ")]),t._v(" "),a("p",{staticClass:"subtitle"},[e.tag_name?a("span",[t._v(t._s(e.tag_name)+" /")]):t._e(),t._v(" "),e.task_name?a("span",[t._v(t._s(e.app_name)+" /")]):t._e(),t._v(" "),a("span",[t._v("来自："+t._s(e.read_creator_name+" "+e.user_department))])]),t._v(" "),a("p",{staticClass:"status",attrs:{title:t.setTitle(e)}},[a("span",[t._v("\n                    发起人：\n                    "),a("i",[t._v(t._s(e.creator_name))]),t._v(" /\n                  ")]),t._v(" "),a("span",[t._v(t._s(e.user_department)+" /")]),t._v(" "),e.created?a("span",[t._v("提交于："+t._s(t.mixSetTime(e.created))+" /")]):t._e(),t._v(" "),a("span",[t._v("总耗时："+t._s(t.appCommonH.getSpendTime(t.mixSetTime(e.created),t.mixSetTime(e.finished)))+" /")]),t._v(" "),0==e.status?a("span",[t._v("\n                    当前环节：\n                    "),a("i",[t._v(t._s(e.nodes[0]&&e.nodes[0].node_name))])]):2==e.status?a("span",{staticClass:"success"},[t._v("成功办理")]):1==e.status?a("span",{staticClass:"stop"},[t._v("终止办理")]):t._e()])])])],1),t._v(" "),a("div",{staticClass:"matter_list_r"},[a("div",[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.showAlert(e,a)}}},[t._v("处理记录")])]),t._v(" "),a("div",[a("router-link",{attrs:{to:{path:"/matter/examine",query:{type:"read",inst_id:e.inst_id,changeStatus:t.changeStatus}}}},[t._v("查看表单")]),t._v(" "),a("router-link",{attrs:{to:{path:"/matter/examine",query:{type:"read",inst_id:e.inst_id,changeStatus:t.changeStatus,showBpmn:1}}}},[t._v("流程跟踪")])],1)])])})),0):[t._m(0)]],2),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":t.p,"page-sizes":[10,20,30,40,50],"page-size":t.page,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.p=e},"update:current-page":function(e){t.p=e}}})],1)])},V=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"nodata"},[s("img",{attrs:{src:a("f1f1"),alt:""}}),t._v(" "),s("p",[t._v("暂无数据")])])}],K={data:function(){return{matterHelper:y["a"],cufe:window.location.hostname.indexOf("cufe")>-1,myReadList:[],appList:[],total:0,finishedNum:0,process_num:0,changeStatus:0,searchLock:!1,searchData:{keyword:null,time_lower:null,time_upper:null,department:null},p:1,page:10}},components:{departSearch:r["l"]},created:function(){"read"==this.$route.query.page&&(this.changeStatus=this.$route.query.changeStatus),this.getMyRead(this.changeStatus),this.getAppNameList()},methods:{getAppNameList:function(){var t=this;this.appFetch({url:"getAppNames",method:"get",data:{type:"launch"}},(function(e){0==e.e?t.appList=e.d:t.$message(e.m)}))},reset:function(){this.searchData={keyword:null,time_lower:null,time_upper:null,department:null},this.$refs.departSearch.close(),this.p=1,this.getMyRead(this.changeStatus)},getMyRead:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this;this.appFetch({method:"get",url:"getMyRead",data:{status:t,p:this.p,keyword:e,time_lower:a,time_upper:s,name_or_number:this.searchData.name_or_number,department:this.searchData.department,page_size:this.page}},(function(e){0==e.e&&(i.myReadList=e.d.list,i.total=e.d.total,1==t&&(i.process_num=String(e.d.process_num)))}))},handleStatus:function(t){this.p=1,this.changeStatus=t,this.req()},search:function(){$(".alert-container").hide(),this.searchLock=!0,this.p=1,this.getMyRead(this.changeStatus,this.searchData.keyword,this.searchData.time_lower,this.searchData.time_upper)},showAlert:function(t,e){this.$emit("showReport",t,e)},handleCurrentChange:function(t){this.req()},handleSizeChange:function(t){this.p=1,this.page=t,this.req(t)},req:function(){if($(".alert-container").hide(),this.searchData)return this.getMyRead(this.changeStatus,this.searchData.keyword,this.searchData.time_lower,this.searchData.time_upper),!1;this.getMyRead(this.changeStatus)},throttle:function(t,e){clearTimeout(t.tId),t.tId=setTimeout((function(){t(e)}),300)},handle:function(t){var e=[];for(var a in t)""!=this.searchData[a]&&null!=this.searchData[a]&&e.push(a);0==e.length&&this.searchLock?(this.p=1,this.searchLock=!1,this.getMyRead(this.changeStatus)):this.searchLock&&(this.p=1,this.getMyRead(this.changeStatus,this.searchData.keyword,this.searchData.time_lower,this.searchData.time_upper))},setTitle:function(t){var e="发起人：".concat(t.creator_name," / ").concat(t.user_department," / ");switch(e+=t.created?"提交于：".concat(this.mixSetTime(t.created)," / "):"",e+="总耗时：".concat(this.appCommonH.getSpendTime(this.mixSetTime(t.created),this.mixSetTime(t.finished))," / "),t.status){case 0:e+="当前环节：".concat(t.nodes[0]&&t.nodes[0].node_name);break;case 1:e+="终止办理";break;case 2:e+="办理成功";break}return e}},watch:{searchData:{handler:function(t){this.throttle(this.handle,t)},deep:!0}},mixins:[k["a"],S["a"]]},X=(a("8058"),Object(n["a"])({name:"read"},K)),W=X,tt=Object(_["a"])(W,J,V,!1,null,null,null),et=tt.exports,at=a("1d8b"),st={data:function(){return{showRoute:"launch",typeNames:{launch:this.$t("system.mySubmit"),todo:this.$t("system.myTask"),oversee:"我的督办",read:"我的知会"},log:null,onlyshow:!1,fudanMatter:!1,currItem:{},showTodoTab:!1,showOverseeTab:!1,showReadTab:!1}},created:function(){this.showRoute=this.$route.query.page?this.$route.query.page:this.mixIndexShowRoute,this.isTab(),this.onlyshow=!!this.$route.query.onlyshow;var t=this.$route.query.changeStatus?this.$route.query.changeStatus:0;this.fudanMatter=!!this.$route.query.fudanMatter,window.localStorage.setItem("SignStatus",t)},mounted:function(){var t=this;$(document).click((function(e){var a=$(".alert-container");a.is(e.target)||0!==a.has(e.target).length||$(".history").is(e.target)||($(".alert-container").hide(),t.log=null)}))},computed:Object(n["a"])({},Object(N["d"])("matter",["task","sponsor"])),methods:{handleReport:function(t,e){this.currItem=t;var a=this;this.log&&t.inst_id==a.log.inst_id?($(".alert-container").hide(),a.log=null):this.appFetch({method:"get",url:t.thirdparty_id?"getThirdpartyLog":"getProcessLog",data:{inst_id:t.inst_id}},(function(s){0==s.e&&(a.log=s.d,a.log.inst_id=t.inst_id,a.showAlert(e))}))},hideAlert:function(t){$(".alert-container").hide(),this.log=null},showAlert:function(t){var e,a;0==this.log.lists.length?(e=$(t.target).offset().top+14-45+"px",a=$(t.target).offset().left-$(".alert-container").width()-20+"px"):1==this.log.lists.length?(e=$(t.target).offset().top+14-76+"px",a=$(t.target).offset().left-$(".alert-container").width()-20+"px"):(e=$(t.target).offset().top+14-110+"px",a=$(t.target).offset().left-$(".alert-container").width()-20+"px"),$(".alert-container").show().css({top:e,left:a})},setAttachmentsUrl:function(t){return this.appCommonH.getUrlStr(at["a"].getApi("downloadAuth"),{file_id:t.file_id,inst_id:this.currItem.inst_id})},isTab:function(){"todo"!=this.showRoute?this.showTodoTabF():this.showTodoTab=!0,"oversee"!=this.showRoute?this.showOverseeTabF():this.showOverseeTab=!0,"read"!=this.showRoute?this.showReadTabF():this.showReadTab=!0},showTodoTabF:function(){var t=this;this.appFetch({url:"getMyTodo",method:"get",data:{status:0,p:1,page_size:1}},(function(e){0==e.e&&(t.showTodoTab=!!e.d.total)}))},showOverseeTabF:function(){var t=this;this.appFetch({url:"getMyOversee",method:"get",data:{status:0,p:1,page_size:1}},(function(e){0==e.e&&(t.showOverseeTab=!!e.d.total)}))},showReadTabF:function(){var t=this;this.appFetch({url:"getMyRead",method:"get",data:{status:0,p:1,page_size:1}},(function(e){0==e.e&&(t.showReadTab=!!e.d.total)}))}},watch:{showRoute:function(){$(".alert-container").hide(),window.localStorage.removeItem("SignStatus")}},mixins:[k["a"],S["a"]]},it=(a("6de4"),a("acae"),Object(n["a"])(Object(n["a"])({name:"index"},st),{},{components:{frontHeader:r["r"],frontFooter:r["q"],breadcrumb:r["i"],toTop:r["I"],launch:T,todo:z,oversee:Q,read:et,feedback:r["o"],fudanHeader:v}})),nt=it,rt=Object(_["a"])(nt,s,i,!1,null,null,null);e["default"]=rt.exports},dc64:function(t,e,a){"use strict";a("fe59"),a("b130"),a("053b"),a("e35a"),a("90aa"),a("0d7a"),a("08ba");var s=a("f7f9"),i=a("e8d2");e["a"]={getAgentParams:function(t,e){if(e=e||1,1==e){var a={primary_uid:0,starter_depart_id:0};t.id&&(a.primary_uid=t.id),t.depart_id&&(a.starter_depart_id=t.depart_id)}else{a={agent_uid:0,agent_department_id:0};t.id&&(a.agent_uid=t.id),t.depart_id&&(a.agent_department_id=t.depart_id)}return a},getScene:function(t,e,a){return"launch"==t?"read":"read"==t?"archive"==e?a?"archive_edit":"archive":"notify":void 0},compatibleData:function(t,e){if(!e||!e.plugins||!e.rtplugins)return t;for(var a in t){var s=a.split("_")[0],n=e.plugins[a]?i["a"].copyObj(e.plugins[a]):"";n&&(["Radio","Select","Checkbox"].includes(s)&&(n.data=t[a],t[a]=this.setComPluginData(n).data))}return t},specialPlugins:["dRadio","dSelect","dCheckbox","dSelectV2"],isSpecialPlugin:function(t){var e=t.split("_")[0];return this.specialPlugins.includes(e)},setComPluginData:function(t){if(this.specialPlugins.includes(t.type)&&("string"===typeof t.data||"number"===typeof t.data||t.data instanceof Array)){var e=t.attr.data.options;switch(e=e||[],t.type){case"dRadio":case"dSelect":var a={};e.forEach((function(e){t.data==e.value&&(a.name=e.name,a.value=e.value)})),t.data=a;break;case"dSelectV2":case"dCheckbox":var s=t.data instanceof Array?t.data:[t.data],i=(a=[],{});e.forEach((function(t){i[t.value]=t})),s.forEach((function(t){var e={};"string"===typeof t||"number"===typeof t?i[t]&&i[t].name&&(e={value:t,name:i[t]?i[t].name:""}):e=t,void 0!==e.value&&a.push(e)})),t.data=a;break}}return t},archiveEditContrast:function(t,e){var a={};for(var s in t)if(e[s])for(var n in a[s]={},t[s]){var r=t[s][n],o=e[s][n];this.paramContrast(r,o,n)&&(a[s][n]=r)}else a[s]=i["a"].copyObj(t[s]);return a},paramContrast:function(t,e,a){if("undefined"==e)return t;if(a.includes("Select")||a.includes("Radio")){if(t.value!=e.value)return t}else if("object"==Object(s["a"])(t)){if(JSON.stringify(t)!=JSON.stringify(e))return t}else if(t!=e)return t;return!1},getFormLength:function(t,e){var a={};return t.length<Math.floor((e-11)/260)?(a.width="230px",a["margin-right"]="30px"):t.length>=Math.floor((e-11)/230)-1&&t.length<Math.floor((e-11)/120)?(a.width="calc(".concat(100/(t.length+1),"% - 11px)"),a["margin-right"]="10px"):(a.width="110px",a["margin-right"]="10px"),a}}},e673:function(t,e,a){"use strict";e["a"]={data:function(){return{mixBNewMatterApplyAuth:!0}}}},f1f1:function(t,e,a){t.exports=a.p+"static/img/nodata.02f36b6f.png"},fc4f6:function(t,e,a){}}]);